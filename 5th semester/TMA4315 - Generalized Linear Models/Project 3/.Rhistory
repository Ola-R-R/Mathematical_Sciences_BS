geom_line(aes(y = abs(age)), color="blue", size = 1) +
geom_line(aes(y = abs(smoke)), color="green", size = 1) +
coord_cartesian(xlim =c(0, 30), ylim = c(-4, 4))
ggplot(data = mat, aes(x = nAGQ)) +
geom_line(aes(y = abs(intercept)), color = "red", size = 1) +
geom_line(aes(y = abs(age)), color="blue", size = 1) +
geom_line(aes(y = abs(smoke)), color="green", size = 1) +
coord_cartesian(xlim =c(0, 30), ylim = c(0, 4))
ggplot(data = mat, aes(x = nAGQ)) +
geom_line(aes(y = intercept), color = "red", size = 1) +
geom_line(aes(y = age), color="blue", size = 1) +
geom_line(aes(y = smoke), color="green", size = 1) +
coord_cartesian(xlim =c(0, 30), ylim = c(-4, 4))
View(ohio)
View(mat)
mat = matrix(rep(0,30), nrow = 31, ncol = 5)
mat = matrix(rep(0,30), NULL, nrow = 31, ncol = 5)
mat[,1] <- rep(0,30)
mat = matrix(, nrow = 31, ncol = 5)
mat[,1] <- rep(0,30)
mat
rep(0,30)
mat[,1] <- t(rep(0,30))
mat[,1] <- seq(0,30,1)
mat
plot(c(1,2),c(1,3))
plot(c(1,2),c(1,3), type = "l")
x <- seq(0,30,1)
plot(x,c(1,3), type = "l")
plot(x,seq(10,40,1), type = "l")
seq(0,30,1)
x <- seq(0,30)
seq(0,30)
plot(x,seq(10,40), type = "l")
x <- seq(0,30)
inter <- c()
ag <- c()
smok <- c()
inter
summary(adap)$coefficients[,1]
x <- seq(0,30)
inter <- c()
ag <- c()
smok <- c()
for (i in 0:30) {
adap <- glmer(resp ~ age + smoke + (1 | id), family = binomial(link = "logit"), ohio, nAGQ = i)
test <- summary(adap)$coefficients[,1]
inter[i] <- test[1]
ag <- test[2]
smok <- test[3]
}
x <- seq(0,30)
inter <- c()
ag <- c()
smok <- c()
for (i in 0:30) {
adap <- glmer(resp ~ age + smoke + (1 | id), family = binomial(link = "logit"), ohio, nAGQ = i)
test <- summary(adap)$coefficients[,1]
inter[i] <- test[1]
ag[i] <- test[2]
smok[i] <- test[3]
}
cbind(inter,ag,smok)
plot(x, inter, type = "l")
x <- seq(0,31)
plot(x, inter, type = "l")
inter
x
for (i in 0:30) {
adap <- glmer(resp ~ age + smoke + (1 | id), family = binomial(link = "logit"), ohio, nAGQ = i)
test <- summary(adap)$coefficients[,1]
inter[i+1] <- test[1]
ag[i+1] <- test[2]
smok[i+1] <- test[3]
}
cbind(inter,ag,smok)
plot(x, inter, type = "l")
inter
cbind(inter,ag,smok,x)
dim(inter)
nrows(inter)
nrow(inter)
ncol(inter)
inter
x <- seq(0,31)
cbind(inter,ag,smok,x)
cbind(inter,ag,smok,x)
cbind(inter,ag,smok)
length(x)
x <- seq(0,30)
cbind(inter,ag,smok,x)
plot(x, inter, type = "l")
lines(x,ag)
lines(x, ag, type = "l")
lines(ag, type = "l")
plot(x, inter, type = "l", ylim=range( c(inter, ag) ))
lines(ag, type = "l")
plot(x, inter, type = "l", ylim=range( c(inter, ag) ), lwd = 2)
lines(ag, type = "l")
ggplot(aes(x = x)) +
geom_line(aes(y = inter), color = "red", size = 1) +
geom_line(aes(y = ag), color="blue", size = 1) +
geom_line(aes(y = smok), color="green", size = 1) +
coord_cartesian(xlim =c(0, 30), ylim = c(-4, 4))
lines(smok, type = "l", lwd = 2)
plot(x, inter, type = "l", ylim=range( c(inter, smoke) ), lwd = 2)
lines(ag, type = "l", lwd = 2)
lines(smok, type = "l", lwd = 2)
plot(x, inter, type = "l", ylim=range( c(-3.5, 2) ), lwd = 2)
lines(ag, type = "l", lwd = 2)
lines(smok, type = "l", lwd = 2)
plot(x, inter, type = "l", ylim=range( c(-3.5, 2) ), lwd = 2, col = "red")
lines(ag, type = "l", lwd = 2, col = "blue")
lines(smok, type = "l", lwd = 2, col = "green")
plot(x, inter, type = "l", ylim=range( c(-3.5, -2) ), lwd = 2, col = "red")
plot(x, ag, type = "l", ylim=range( c(-3.5, -2) ), lwd = 2, col = "blue")
plot(x, smok, type = "l", ylim=range( c(-3.5, -2) ), lwd = 2, col = "green")
ag
plot(x, ag, type = "l", ylim=range( c(-2, 1) ), lwd = 2, col = "blue")
plot(x, ag, type = "l", ylim=range( c(-0.2, -0.1) ), lwd = 2, col = "blue")
min(ag)
plot(x, ag, type = "l", ylim=range( c(min(ag), max(ag)) ), lwd = 2, col = "blue")
plot(x, inter, type = "l", ylim=range(c(min(inter), max(inter))), lwd = 2, col = "red")
plot(x, smok, type = "l", ylim=range(c(min(smok), max(smok))), lwd = 2, col = "green")
logl <- c()
logl
for (i in 0:30) {
adap <- glmer(resp ~ age + smoke + (1 | id), family = binomial(link = "logit"), ohio, nAGQ = i)
logl[i+1] <- head(logLik(adap))
}
logl
plot(x, logl, type = "l", ylim=range(c(min(logl), max(logl))), lwd = 2, col = "pink")
plot(x, logl, type = "l", ylim=range(c(min(logl), max(logl))), lwd = 2, col = "darkpink")
plot(x, logl, type = "l", ylim=range(c(min(logl), max(logl))), lwd = 2, col = "990033")
plot(x, logl, type = "l", ylim=range(c(min(logl), max(logl))), lwd = 2, col = "#990033")
pnorm(2/sqrt(2))
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = TRUE, tidy.opts = list(width.cutoff = 60), tidy = TRUE)
library("geepack")
library("lme4")
library("tidyverse")
library("aod")
library("lmtest")
library("readxl")
library("VGAM")
library("broom")
library("ggfortify")
library("MASS")
library("dampack")
library("mdscore")
library("formatR")
library("RLRsim")
library("sjPlot")
library("Matrix")
library("mvtnorm")
data(ohio)
modglmm <- glmer(resp ~ age + smoke + (1 | id), family = binomial(link = "logit"), ohio)
summary(modglmm)$coefficients
modglm <- glm(resp ~ age + smoke, family = binomial(link = "logit"), ohio)
summary(modglm)$coefficients
cat("Conditional odds", exp(summary(modglmm)$coefficients[3,1]), "\nMarginal odds", exp((1 + 0.6 * (0.28704)^2) * summary(modglm)$coefficients[3,1]))
modglmmage <- glmer(resp ~ age + smoke + (1 + age | id), family = binomial(link = "logit"), ohio)
summary(modglmmage)
lrtage <- head(2 * (logLik(modglmmage) - logLik(modglmm)))
modglmmsmoke <- glmer(resp ~ age + smoke + (1 + smoke | id), family = binomial(link = "logit"), ohio)
summary(modglmmsmoke)
lrtsmoke <- head(2 * (logLik(modglmmsmoke) - logLik(modglmm)))
pvalage <- 0.5 * pchisq(lrtage, 1, lower.tail = F) + 0.5 * pchisq(lrtage, 2, lower.tail = F)
pvalsmoke <- 0.5 * pchisq(lrtsmoke, 1, lower.tail = F) + 0.5 * pchisq(lrtsmoke, 2, lower.tail = F)
cat("p-value of modglmmage:", pvalage, "\np-value of modglmmsmoke:", pvalsmoke)
alpha <- 0.05
f <- function(x) {
0.5 * pchisq(x, 1, lower.tail = T) + 0.5 * pchisq(x, 2, lower.tail = T) - (1 - alpha)
}
crit <- uniroot(f, c(0,100))$root
cat("The critical value is", crit, "\nLRT of age model:", lrtage, "\nLRT of model:", lrtsmoke)
x <- seq(0,30)
inter <- c()
ag <- c()
smok <- c()
logl <- c()
for (i in 0:30) {
adap <- glmer(resp ~ age + smoke + (1 | id), family = binomial(link = "logit"), ohio, nAGQ = i)
test <- summary(adap)$coefficients[,1]
inter[i+1] <- test[1]
ag[i+1] <- test[2]
smok[i+1] <- test[3]
logl[i+1] <- head(logLik(adap))
}
plot(x, inter, type = "l", ylim=range( c(-3.5, 2) ), lwd = 2, col = "red")
lines(ag, type = "l", lwd = 2, col = "blue")
lines(smok, type = "l", lwd = 2, col = "green")
testdata <- matrix()
testdata
testdata[,1] <- x
testdata <- matrix(, nrow = 31, ncol = 4)
testdata
testdata[,1] <- x
testdata
logl
testdata <- matrix(, nrow = 31, ncol = 4)
testdata[,1] <- x
testdata[,2] <- inter
testdata[,3] <- ag
testdata[,4] <- logl
testdata <- dataframe(testdata)
testdata
testdata <- data.frame(testdata)
testdata
convergence.plot(testdata,c("X1","x2"))
install.packages("FlexReg")
library("FlexReg")
library("FlexReg")
convergence.plot(testdata,c("X1","x2"))
testdata
View(testdata)
library(FlexReg)
convergence.plot(testdata,c("X1","x2"))
plot(x, inter, type = "l", ylim=range(c(min(inter), max(inter))), lwd = 2, col = "red")
abline(-3.1)
abline(h = -3.1)
abline(h = -3.1014)
plot(x, inter, type = "l", ylim=range(c(min(inter), max(inter))), lwd = 2, col = "red")
abline(h = -3.1014)
testdata <- matrix(, nrow = 31, ncol = 4)
testdata[,1] <- x
testdata[,2] <- inter
testdata[,3] <- ag
testdata[,4] <- smok
testdata[,5] <- logl
testdata
testdata <- matrix(, nrow = 31, ncol = 5)
testdata[,1] <- x
testdata[,2] <- inter
testdata[,3] <- ag
testdata[,4] <- smok
testdata[,5] <- logl
testdata <- data.frame(testdata)
testdata
plot(x, inter, type = "l", ylim=range( c(-3.5, 2) ), lwd = 2, col = "red")
lines(ag, type = "l", lwd = 2, col = "blue")
lines(smok, type = "l", lwd = 2, col = "green")
abline(h = -3.1014)
abline(h = -0.1756)
abline(h = 0.39855)
plot(x, ag, type = "l", ylim=range(c(min(ag), max(ag))), lwd = 2, col = "blue")
abline(h = -0.1756)
plot(x, smok, type = "l", ylim=range(c(min(smok), max(smok))), lwd = 2, col = "green")
abline(h = 0.39855)
plot(x, logl, type = "l", ylim=range(c(min(logl), max(logl))), lwd = 2, col = "#990033")
abline(h = -797.649)
plot(x, inter, type = "l", ylim=range( c(-3.5, 2) ), lwd = 2, col = "red", xlab="nAGQ", ylab="y")
plot(x, inter, type = "l", ylim=range( c(-3.5, 2) ), lwd = 2, col = "red", xlab="nAGQ", ylab="y")
lines(ag, type = "l", lwd = 2, col = "blue")
lines(smok, type = "l", lwd = 2, col = "green")
abline(h = -3.1014)
abline(h = -0.1756)
abline(h = 0.39855)
plot(x, inter, type = "l", ylim=range( c(-3.5, 2) ), lwd = 2, col = "red", xlab="nAGQ", ylab="y")
lines(ag, type = "l", lwd = 2, col = "blue")
lines(smok, type = "l", lwd = 2, col = "green")
legend(1, 95, legend=c("Line 1", "Line 2"),
col=c("red", "blue"), lty=1:2, cex=0.8)
legend(1, 95, legend=c("Line 1", "Line 2", "test"),
col=c("red", "blue", "green"), lty=1:2, cex=0.8)
plot(x, inter, type = "l", ylim=range( c(-3.5, 2) ), lwd = 2, col = "red", xlab="nAGQ", ylab="Estimated parameters", lty=1)
plot(x, inter, type = "l", ylim=range( c(-3.5, 2) ), lwd = 2, col = "red", xlab="nAGQ", ylab="Estimated parameters", lty=1, pch=19)
plot(x, inter, type = "l", ylim=range( c(-3.5, 2) ), lwd = 2, col = "red", xlab="nAGQ", ylab="Estimated parameters", lty=1, pch=19)
plot(x, inter, type = "l", ylim=range( c(-3.5, 2) ), lwd = 2, col = "red", xlab="nAGQ", ylab="Estimated parameters", lty=1, pch=19, type="b")
plot(x, inter, type = "l", ylim=range( c(-3.5, 2) ), lwd = 2, col = "red", xlab="nAGQ", ylab="Estimated parameters", lty = 1, pch = 19)
lines(ag, type = "l", lwd = 2, col = "blue")
lines(smok, type = "l", lwd = 2, col = "green")
plot(x, inter, type = "l", ylim = range(c(-3.5, 2)), xlim = range(c(-5,30)), lwd = 2, col = "red", xlab="nAGQ", ylab="Estimated parameters")
lines(ag, type = "l", lwd = 2, col = "blue")
lines(smok, type = "l", lwd = 2, col = "green")
legend("topleft", legend=c("Line 1", "Line 2", "test"),
col=c("red", "blue", "green"), lty=1:3, cex=0.8)
plot(x, inter, type = "l", ylim = range(c(-3.5, 2)), xlim = range(c(-2,30)), lwd = 2, col = "red", xlab="nAGQ", ylab="Estimated parameters")
lines(ag, type = "l", lwd = 2, col = "blue")
lines(smok, type = "l", lwd = 2, col = "green")
legend("topleft", legend=c("Line 1", "Line 2", "test"),
col=c("red", "blue", "green"), lty=1:3, cex=0.8)
lines(ag, type = "l", lty=1, lwd = 2, col = "blue")
plot(x, inter, type = "l", ylim = range(c(-3.5, 2)), xlim = range(c(-2,30)), lwd = 2, col = "red", xlab="nAGQ", ylab="Estimated parameters")
lines(ag, type = "l", lty=1, lwd = 2, col = "blue")
lines(ag, type = "l", lty=2, lwd = 2, col = "blue")
lines(ag, type = "l", lty=2, lwd = 2, col = "blue")
plot(x, inter, type = "l", ylim = range(c(-3.5, 2)), xlim = range(c(-2,30)), lwd = 2, col = "red", xlab="nAGQ", ylab="Estimated parameters")
lines(ag, type = "l", lty=2, lwd = 2, col = "blue")
lines(ag, lty=2, lwd = 2, col = "blue")
plot(x, inter, type = "l", ylim = range(c(-3.5, 2)), xlim = range(c(-2,30)), lty=1, col = "red", xlab="nAGQ", ylab="Estimated parameters")
plot(x, inter, lty = 1 , ylim = range(c(-3.5, 2)), xlim = range(c(-2,30)), lwd = 2, col = "red", xlab="nAGQ", ylab="Estimated parameters")
plot(x, inter, lty = 1 , ylim = range(c(-3.5, 2)), xlim = range(c(-2,30)), lwd = 2, col = "red", xlab="nAGQ", ylab="Estimated parameters")
lines(ag, lty=2, lwd = 2, col = "blue")
lines(smok, type = "l", lwd = 2, col = "green")
legend("topleft", legend=c("Intercept", "Age", "Smoke"),
col=c("red", "blue", "green"), lty = 1:3, cex = 0.8)
# abline(h = -3.1014)
# abline(h = -0.1756)
# abline(h = 0.39855)
plot(x, inter, lty = 1 , ylim = range(c(-3.5, 2)), xlim = range(c(-2,30)), lwd = 2, col = "red", xlab="nAGQ", ylab="Estimated parameters")
lines(ag, lty=2, lwd = 2, col = "blue")
lines(smok, lty = 3, lwd = 2, col = "green")
legend("topleft", legend=c("Intercept", "Age", "Smoke"),
col=c("red", "blue", "green"), lty = 1:3, cex = 0.8)
# abline(h = -3.1014)
# abline(h = -0.1756)
# abline(h = 0.39855)
plot(x, inter,type="b", pch=19, ylim = range(c(-3.5, 2)), xlim = range(c(-2,30)), lwd = 2, col = "red", xlab="nAGQ", ylab="Estimated parameters")
lines(ag, type="b", pch = 18, lwd = 2, col = "blue")
lines(smok, type="b", pch=19, lty = 3, lwd = 2, col = "green")
lines(smok, type="b", pch=17, lty = 3, lwd = 2, col = "green")
plot(x, inter, type="b", pch=19, ylim = range(c(-3.5, 2)), xlim = range(c(-2,30)), lwd = 2, col = "red", xlab="nAGQ", ylab="Estimated parameters")
lines(ag, type="b", pch = 18, lwd = 2, col = "blue")
lines(smok, type="b", pch=17, lty = 3, lwd = 2, col = "green")
legend("topleft", legend=c("Intercept", "Age", "Smoke"),
col=c("red", "blue", "green"), lty = 1:3, cex = 0.8)
# abline(h = -3.1014)
# abline(h = -0.1756)
# abline(h = 0.39855)
plot(x, inter, type="b", ylim = range(c(-3.5, 2)), xlim = range(c(-2,30)), lwd = 2, col = "red", xlab="nAGQ", ylab="Estimated parameters")
lines(ag, type="b", lwd = 2, col = "blue")
lines(smok, type="b", lty = 3, lwd = 2, col = "green")
plot(x, inter, lty = 1, ylim = range(c(-3.5, 2)), xlim = range(c(-2,30)), lwd = 2, col = "red", xlab="nAGQ", ylab="Estimated parameters")
lines(ag, lty = 2, lwd = 2, col = "blue")
lines(smok, lty = 3, lwd = 2, col = "green")
legend("topleft", legend=c("Intercept", "Age", "Smoke"),
col=c("red", "blue", "green"), lty = 1:3, cex = 0.8)
# abline(h = -3.1014)
# abline(h = -0.1756)
# abline(h = 0.39855)
plot(x, inter, type = "l", ylim = range(c(-3.5, 2)), xlim = range(c(-2,30)), lwd = 2, col = "red", xlab="nAGQ", ylab="Estimated parameters")
lines(ag, lty = 2, lwd = 2, col = "blue")
lines(smok, lty = 3, lwd = 2, col = "green")
legend("topleft", legend=c("Intercept", "Age", "Smoke"),
col=c("red", "blue", "green"), lty = 1:3, cex = 0.8)
plot(x, inter, type = "l", ylim=range(c(min(inter), max(inter))), lwd = 2, col = "red")
abline(h = -3.1014)
abline(h = -3.1014, lty = 4)
plot(x, inter, type = "l", ylim=range(c(min(inter), max(inter))), lwd = 2, col = "red")
abline(h = -3.1014, lty = 4)
abline(h = -3.1014, lty = 4, lwd = 2)
plot(x, inter, type = "l", ylim=range(c(min(inter), max(inter))), lwd = 2, col = "red")
abline(h = -3.1014, lty = 4, lwd = 1.5)
plot(x, inter, type = "l", ylim=range(c(min(inter), max(inter))), lwd = 2, col = "red")
abline(h = -3.1014, lty = 4, lwd = 1.5)
plot(x, ag, type = "l", ylim=range(c(min(ag), max(ag))), lwd = 2, col = "blue", xlab="nAGQ", ylab="Age")
abline(h = -0.1756, lty = 4, lwd = 1.5)
plot(x, smok, type = "l", ylim=range(c(min(smok), max(smok))), lwd = 2, col = "green", xlab="nAGQ", ylab="Smoke")
abline(h = 0.39855, lty = 4, lwd = 1.5)
plot(x, logl, type = "l", ylim=range(c(min(logl), max(logl))), lwd = 2, col = "#990033")
abline(h = -797.649)
plot(x, logl, type = "l", ylim=range(c(min(logl), max(logl))), lwd = 2, col = "#990033", xlab="nAGQ", ylab="Log Likelihood")
abline(h = -797.649)
plot(x, inter, type = "l", ylim = range(c(-3.5, 2)), xlim = range(c(-2,30)), lwd = 2, col = "red", xlab="nAGQ", ylab="Estimated parameters")
lines(ag, lty = 2, lwd = 2, col = "blue")
lines(smok, lty = 3, lwd = 2, col = "green")
legend("topleft", legend=c("Intercept", "Age", "Smoke"),
col=c("red", "blue", "green"), lty = 1:3, cex = 0.8)
plot(x, ag, type = "l", ylim=range(c(min(ag), max(ag))), lwd = 2, col = "blue", xlab="nAGQ", ylab="Age")
abline(h = -0.1756, lty = 4, lwd = 1.5)
plot(x, smok, type = "l", ylim=range(c(min(smok), max(smok))), lwd = 2, col = "green", xlab="nAGQ", ylab="Smoke")
abline(h = 0.39855, lty = 4, lwd = 1.5)
modglmmage <- glmer(resp ~ age + smoke + (1 + age | id), family = binomial(link = "logit"), ohio)
# summary(modglmmage)
modglmmsmoke <- glmer(resp ~ age + smoke + (1 + smoke | id), family = binomial(link = "logit"), ohio)
# summary(modglmmsmoke)
lrtage <- head(2 * (logLik(modglmmage) - logLik(modglmm)))
lrtsmoke <- head(2 * (logLik(modglmmsmoke) - logLik(modglmm)))
rsleepmodF = lme4::lmer(Reaction ~ 1 + Days + (1 + Days|Subject), REML= F, data = sleepstudy)
summary(rsleepmodF)
VarCorr(rsleepmodF)
sleepmodF <- mylmm(y = sleepstudy$Reaction, x = sleepstudy$Days, group = sleepstudy$Subject, REML = F)
# Chunk 1: setup
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = TRUE, tidy.opts = list(width.cutoff = 60), tidy = TRUE)
library("geepack")
library("lme4")
library("tidyverse")
library("aod")
library("lmtest")
library("readxl")
library("VGAM")
library("broom")
library("ggfortify")
library("MASS")
library("dampack")
library("mdscore")
library("formatR")
library("RLRsim")
library("sjPlot")
library("Matrix")
library("mvtnorm")
# Chunk 2
mylmm = function(y, x, group, REML) {
m <- nlevels(group)
X = model.matrix( ~ 1 + x)
# Computing U
U <- list() # set up an empty list
for (i in 1:m) {
# Construct and assign i'th block to i'th list element
U[[i]] <- cbind(1, x[group==unique(group)[i]])
}
# Change the list to a block diagonal matrix
U <- bdiag(U)
# G(theta)
getG <- function(theta) {
gg <- matrix(c(theta[1], theta[3] * sqrt(theta[1] * theta[2]), theta[3] * sqrt(theta[1] * theta[2]), theta[2]), nrow = 2, byrow = T)
gm <- list()
for(i in 1:m){
gm[[i]] = gg
}
return (bdiag(gm))
}
# R(theta)
getR <- function(theta) {
return (diag(rep(theta[4], length(y))))
}
# V(theta)
getV <- function(theta) {
return (as.matrix(U %*% getG(theta) %*% t(U) + getR(theta)))
}
# beta(theta)
getBeta <- function(theta) {
return (solve(t(X) %*% solve(getV(theta)) %*% X) %*% t(X) %*% solve(getV(theta)) %*% y)
}
# log likelihood, REML if true
loglik <- function(theta) {
V <- getV(theta)
betah <- getBeta(theta)
l <- -.5 * (determinant(V)$modulus + t(y - X %*% betah) %*% solve(V) %*% (y - X %*% betah))
if (REML)
l <- l - .5 * determinant(t(X) %*% solve(V) %*% X)$modulus
l
}
opt <- optim(c(1,1,1,1), fn = loglik, method = "L-BFGS-B", control = list(fnscale = -1), lower = c(0,0,-1,0), upper = c(Inf,Inf,1,Inf))
theta <- opt$par
thetam <- matrix(c(theta[1], sqrt(theta[1]), NaN, theta[2], sqrt(theta[2]), theta[3]), nrow = 2, ncol = 3, byrow = TRUE, dimnames = list(c("(Intercept)", "Days"), c("Variance", "Std.Dev.", "Corr.")))
betas <- getBeta(theta)
var <- solve(t(X) %*% solve(getV(theta)) %*%X)
sdev <- sqrt(diag(var))
corr <- var[1,2] / (sdev[1] * sdev[2])
corrm <- matrix(corr, byrow = TRUE, dimnames = list(c("Days"), c("(Intr)")))
fixedeff <- matrix(c(betas[1], sdev[1], betas[2], sdev[2]), nrow = 2, ncol = 2, byrow = TRUE, dimnames = list(c("(Intercept)", "Days"), c("Estimate", "Std_Error")))
list("Random effects covariance matrix:" = thetam, "Correlation of Fixed Effects" = fixedeff, "Correlation of Fixed Effects:" = corrm)
}
sleepmodF <- mylmm(y = sleepstudy$Reaction, x = sleepstudy$Days, group = sleepstudy$Subject, REML = F)
sleepmodF
VarCorr(rsleepmodF)
summary(rsleepmodF)$coefficients
summary(rsleepmodF)$coefficients[1:2,1:2]
VarCorr(rsleepmodF)
VarCorr(rsleepmodF)[1,1:3]
VarCorr(rsleepmodF)[1,1:2]
VarCorr(rsleepmodF)[1]
VarCorr(rsleepmodF)
test <- VarCorr(rsleepmodF)
View(test)
sleepmodF
cov2cor(vcov(rsleepmodF))
cov2cor(vcov(rsleepmodF))[1,2]
modglmm <- glmer(resp ~ age + smoke + (1 | id), family = binomial(link = "logit"), ohio)
summary(modglmm)$coefficients
modglm <- glm(resp ~ age + smoke, family = binomial(link = "logit"), ohio)
summary(modglm)$coefficients
summary(modglmm)$coefficients[,2]
summary(modglm)$coefficients[,2]
cov2cor(vcov(rsleepmodF))
sleepmodF
sleepmodF
list("Random effects:" = VarCorr(rsleepmodF), "Fixed Effects" = summary(rsleepmodF)$coefficients[1:2,1:2], "Correlation of Fixed Effects:" = cov2cor(vcov(rsleepmodF)))
plot(x, inter, type = "l", ylim = range(c(-3.5, 2)), xlim = range(c(-2,30)), lwd = 2, col = "red", xlab="nAGQ", ylab="Estimated parameters")
lines(ag, lty = 2, lwd = 2, col = "blue")
lines(smok, lty = 4, lwd = 2, col = "green")
legend("topleft", legend=c("Intercept", "Age", "Smoke"),
col=c("red", "blue", "green"), lty = c(1,2,3), cex = 0.8)
legend("topleft", legend=c("Intercept", "Age", "Smoke"),
col=c("red", "blue", "green"), lty = c(1,2,4), cex = 0.8)
lines(smok, lty = 5, lwd = 2, col = "green")
plot(x, inter, type = "l", ylim = range(c(-3.5, 2)), xlim = range(c(-2,30)), lwd = 2, col = "red", xlab="nAGQ", ylab="Estimated parameters")
lines(ag, lty = 2, lwd = 2, col = "blue")
lines(smok, lty = 5, lwd = 2, col = "green")
legend("topleft", legend=c("Intercept", "Age", "Smoke"),
col=c("red", "blue", "green"), lty = c(1,2,4), cex = 0.8)
plot(x, inter, type = "l", ylim = range(c(-3.5, 2)), xlim = range(c(-2,30)), lwd = 2, col = "red", xlab="nAGQ", ylab="Estimated parameters")
lines(ag, lty = 5, lwd = 2, col = "blue")
lines(smok, lty = 2, lwd = 2, col = "green")
legend("topleft", legend=c("Intercept", "Age", "Smoke"),
col=c("red", "blue", "green"), lty = c(1,5,2), cex = 0.8)
plot(x, inter, type = "l", ylim=range(c(min(inter), max(inter))), lwd = 2, col = "red", xlab="nAGQ", ylab="Intercept")
abline(h = -3.1014, lty = 4, lwd = 1.5)
plot(x, ag, type = "l", ylim=range(c(min(ag), max(ag))), lwd = 2, col = "blue", xlab="nAGQ", ylab="Age")
abline(h = -0.1756, lty = 4, lwd = 1.5)
plot(x, ag, ylim=range(c(min(ag), max(ag))), lty = 5, lwd = 2, col = "blue", xlab="nAGQ", ylab="Age")
abline(h = -0.1756, lty = 4, lwd = 1.5)
plot(x, smok, ylim=range(c(min(smok), max(smok))), lty = 2, lwd = 2, col = "green", xlab="nAGQ", ylab="Smoke")
abline(h = 0.39855, lty = 4, lwd = 1.5)
plot(x, ag, ylim=range(c(min(ag), max(ag))), lty = 5, lwd = 2, col = "blue", xlab="nAGQ", ylab="Age")
abline(h = -0.1756, lty = 4, lwd = 1.5)
plot(x, ag, type = "l", ylim=range(c(min(ag), max(ag))), lty = 5, lwd = 2, col = "blue", xlab="nAGQ", ylab="Age")
abline(h = -0.1756, lty = 4, lwd = 1.5)
plot(x, smok, type = "l", ylim=range(c(min(smok), max(smok))), lty = 2, lwd = 2, col = "green", xlab="nAGQ", ylab="Smoke")
abline(h = 0.39855, lty = 4, lwd = 1.5)
plot(x, ag, type = "l", ylim=range(c(min(ag), max(ag))), lwd = 2, col = "blue", xlab="nAGQ", ylab="Age")
abline(h = -0.1756, lty = 4, lwd = 1.5)
plot(x, smok, type = "l", ylim=range(c(min(smok), max(smok))), lwd = 2, col = "green", xlab="nAGQ", ylab="Smoke")
abline(h = 0.39855, lty = 4, lwd = 1.5)
plot(x, inter, type = "l", ylim = range(c(-3.5, 2)), xlim = range(c(-2,30)), lwd = 2, col = "red", xlab="nAGQ", ylab="Estimated parameters")
lines(ag, lty = 5, lwd = 2, col = "blue")
lines(smok, lty = 2, lwd = 2, col = "green")
legend("topleft", legend=c("Intercept", "Age", "Smoke"),
col=c("red", "blue", "green"), lty = c(1,5,2), cex = 0.8)
plot(x, logl, type = "l", ylim=range(c(min(logl), max(logl))), lwd = 2, col = "#990033", xlab="nAGQ", ylab="Log Likelihood")
abline(h = -797.649, lty = 4, lwd = 1.5)
