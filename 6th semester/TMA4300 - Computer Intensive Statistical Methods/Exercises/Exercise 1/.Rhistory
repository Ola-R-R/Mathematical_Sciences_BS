x <- -(1/rate) * u
return(x)
}
n = 1000
rate = 1
hist(r_exp_Distr(n, rate), main = paste("Histogram of our function"), freq = F, col = "darkgray", lwd = 4)
lines(x = seq(0, 10, length.out = n), dexp(x = seq(0, 10, length.out = n), rate = rate), col="blue", lwd = 3)
legend(4, 0.6, c("Density of our function", "Density of true exponential distribution"), col = c("darkgray", "blue"), lty = c(1, 1), lwd = c(4, 4))
set.seed(98)
r_exp_Distr <- function(n, rate) {
u <- log(runif(n))
x <- -(1/rate) * u
return(x)
}
hist(r_exp_Distr(1000, 1), main = paste("Histogram of our function"), freq = F, col = "darkgray", lwd = 4)
lines(x = seq(0, 10, length.out = 1000), dexp(x = seq(0, 10, length.out = 1000), rate = 1), col="blue", lwd = 3)
legend(3, 0.6, c("Density of our function", "Density of true exponential distribution"), col = c("darkgray", "blue"), lty = c(1, 1), lwd = c(4, 4))
set.seed(98)
r_exp_Distr <- function(n, rate) {
u <- log(runif(n))
x <- -(1/rate) * u
return(x)
}
hist(r_exp_Distr(1000, 1), main = paste("Histogram of our function"), freq = F, col = "darkgray", lwd = 4)
lines(x = seq(0, 10, length.out = 1000), dexp(x = seq(0, 10, length.out = 1000), rate = 1), col="blue", lwd = 3)
legend(3, 0.6, c("Density of our function", "Density of true exponential distribution"), col = c("darkgray", "blue"), lty = c(1, 1), lwd = c(4, 4))
set.seed(98)
r_exp_Distr <- function(n, rate) {
u <- log(runif(n))
x <- -(1/rate) * u
return(x)
}
hist(r_exp_Distr(1000, 1), main = paste("Histogram of our function"), freq = F, col = "darkgray", lwd = 4)
lines(x = seq(0, 10, length.out = 1000), dexp(x = seq(0, 10, length.out = 1000), rate = 1), col="blue", lwd = 3)
legend(2, 0.6, c("Density of our function", "Density of true exponential distribution"), col = c("darkgray", "blue"), lty = c(1, 1), lwd = c(4, 4))
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = TRUE, tidy.opts = list(width.cutoff = 60), tidy = TRUE)
library("tidyverse")
library("ggfortify")
library("MASS")
set.seed(98)
r_exp_Distr <- function(n, rate) {
u <- log(runif(n))
x <- -(1/rate) * u
return(x)
}
hist(r_exp_Distr(1000, 1), main = paste("Histogram of our function"), freq = F, col = "darkgray", lwd = 4) #Making the histogram of our function
lines(x = seq(0, 10, length.out = 1000), dexp(x = seq(0, 10, length.out = 1000), rate = 1), col="blue", lwd = 3) #Showing the true exponential distribution
legend(2, 0.6, c("Density of our function", "Density of true exponential distribution"), col = c("darkgray", "blue"), lty = c(1, 1), lwd = c(4, 4))
r_exp_Distr <- function(n, rate) {
u <- log(runif(n))
x <- -(1/rate) * u
return(x)
}
hist(r_exp_Distr(1000, 1), main = paste("Histogram of our function"), freq = F, col = "darkgray", lwd = 4) #Making the histogram of our function
lines(x = seq(0, 10, length.out = 1000), dexp(x = seq(0, 10, length.out = 1000), rate = 1), col="blue", lwd = 3) #Showing the true exponential distribution
legend(2, 0.6, c("Density of our function", "Density of true exponential distribution"), col = c("darkgray", "blue"), lty = c(1, 1), lwd = c(4, 4))
r_exp_Distr <- function(n, rate) {
u <- log(runif(n))
x <- -(1/rate) * u
return(x)
}
hist(r_exp_Distr(1000, 1), main = paste("Histogram of our function"), freq = F, col = "darkgray", lwd = 4) #Making the histogram of our function
lines(x = seq(0, 10, length.out = 1000), dexp(x = seq(0, 10, length.out = 1000), rate = 1), col="blue", lwd = 3) #Showing the true exponential distribution
legend(2, 0.6, c("Density of our function", "Density of true exponential distribution"), col = c("darkgray", "blue"), lty = c(1, 1), lwd = c(4, 4))
r_exp_Distr <- function(n, rate) {
u <- log(runif(n))
x <- -(1/rate) * u
return(x)
}
hist(r_exp_Distr(1000, 1), main = paste("Histogram of our function"), freq = F, col = "darkgray", lwd = 4) #Making the histogram of our function
lines(x = seq(0, 10, length.out = 1000), dexp(x = seq(0, 10, length.out = 1000), rate = 1), col="blue", lwd = 3) #Showing the true exponential distribution
legend(2, 0.6, c("Density of our function", "Density of true exponential distribution"), col = c("darkgray", "blue"), lty = c(1, 1), lwd = c(4, 4))
r_exp_Distr <- function(n, rate) {
u <- log(runif(n))
x <- -(1/rate) * u
return(x)
}
hist(r_exp_Distr(1000, 1), main = paste("Histogram of our function"), freq = F, col = "darkgray", lwd = 4) #Making the histogram of our function
lines(x = seq(0, 10, length.out = 1000), dexp(x = seq(0, 10, length.out = 1000), rate = 1), col="blue", lwd = 3) #Showing the true exponential distribution
legend(2, 0.6, c("Density of our function", "Density of true exponential distribution"), col = c("darkgray", "blue"), lty = c(1, 1), lwd = c(4, 4))
r_exp_Distr <- function(n, rate) {
u <- log(runif(n))
x <- -(1/rate) * u
return(x)
}
hist(r_exp_Distr(1000, 1), main = paste("Histogram of our function"), freq = F, col = "darkgray", lwd = 4) #Making the histogram of our function
lines(x = seq(0, 10, length.out = 1000), dexp(x = seq(0, 10, length.out = 1000), rate = 1), col="blue", lwd = 3) #Showing the true exponential distribution
legend(2, 0.6, c("Density of our function", "Density of true exponential distribution"), col = c("darkgray", "blue"), lty = c(1, 1), lwd = c(4, 4))
r_exp_Distr <- function(n, rate) {
u <- log(runif(n))
x <- -(1/rate) * u
return(x)
}
hist(r_exp_Distr(1000, 1), main = paste("Histogram of our function"), freq = F, col = "darkgray", lwd = 4) #Making the histogram of our function
lines(x = seq(0, 10, length.out = 1000), dexp(x = seq(0, 10, length.out = 1000), rate = 1), col="blue", lwd = 3) #Showing the true exponential distribution
legend(2, 0.6, c("Density of our function", "Density of true exponential distribution"), col = c("darkgray", "blue"), lty = c(1, 1), lwd = c(4, 4))
set.seed(98)
r_exp_Distr <- function(n, rate) {
u <- log(runif(n))
x <- -(1/rate) * u
return(x)
}
hist(r_exp_Distr(1000, 1), main = paste("Histogram of our function"), freq = F, col = "darkgray", lwd = 4) #Making the histogram of our function
lines(x = seq(0, 10, length.out = 1000), dexp(x = seq(0, 10, length.out = 1000), rate = 1), col="blue", lwd = 3) #Showing the true exponential distribution
legend(2, 0.6, c("Density of our function", "Density of true exponential distribution"), col = c("darkgray", "blue"), lty = c(1, 1), lwd = c(4, 4))
set.seed(18)
r_exp_Distr <- function(n, rate) {
u <- log(runif(n))
x <- -(1/rate) * u
return(x)
}
hist(r_exp_Distr(1000, 1), main = paste("Histogram of our function"), freq = F, col = "darkgray", lwd = 4) #Making the histogram of our function
lines(x = seq(0, 10, length.out = 1000), dexp(x = seq(0, 10, length.out = 1000), rate = 1), col="blue", lwd = 3) #Showing the true exponential distribution
legend(2, 0.6, c("Density of our function", "Density of true exponential distribution"), col = c("darkgray", "blue"), lty = c(1, 1), lwd = c(4, 4))
set.seed(18)
r_exp_Distr <- function(n, rate) {
u <- log(runif(n))
x <- -(1/rate) * u
return(x)
}
hist(r_exp_Distr(1000, 1), main = paste("Histogram of our function"), freq = F, col = "darkgray", lwd = 4) #Making the histogram of our function
lines(x = seq(0, 10, length.out = 1000), dexp(x = seq(0, 10, length.out = 1000), rate = 1), col="blue", lwd = 3) #Showing the true exponential distribution
legend(2, 0.6, c("Density of our function", "Density of true exponential distribution"), col = c("darkgray", "blue"), lty = c(1, 1), lwd = c(4, 4))
set.seed(18)
r_exp_Distr <- function(n, rate) {
u <- log(runif(n))
x <- -(1/rate) * u
return(x)
}
hist(r_exp_Distr(1000, 1), main = paste("Histogram of our function"), freq = F, col = "darkgray", lwd = 4) #Making the histogram of our function
lines(x = seq(0, 10, length.out = 1000), dexp(x = seq(0, 10, length.out = 1000), rate = 1), col="blue", lwd = 3) #Showing the true exponential distribution
legend(2, 0.6, c("Density of our function", "Density of true exponential distribution"), col = c("darkgray", "blue"), lty = c(1, 1), lwd = c(4, 4))
set.seed(18)
r_exp_Distr <- function(n, rate) {
u <- log(runif(n))
x <- -(1/rate) * u
return(x)
}
hist(r_exp_Distr(1000, 1), main = paste("Histogram of our function"), freq = F, col = "darkgray", lwd = 4) #Making the histogram of our function
lines(x = seq(0, 10, length.out = 1000), dexp(x = seq(0, 10, length.out = 1000), rate = 1), col="blue", lwd = 3) #Showing the true exponential distribution
legend(2, 0.6, c("Density of our function", "Density of true exponential distribution"), col = c("darkgray", "blue"), lty = c(1, 1), lwd = c(4, 4))
set.seed(18)
r_exp_Distr <- function(n, rate) {
u <- log(runif(n))
x <- -(1/rate) * u
return(x)
}
hist(r_exp_Distr(1000, 1), main = paste("Histogram of our function"), freq = F, col = "darkgray", lwd = 4) #Making the histogram of our function
lines(x = seq(0, 10, length.out = 1000), dexp(x = seq(0, 10, length.out = 1000), rate = 1), col="blue", lwd = 3) #Showing the true exponential distribution
legend(2, 0.6, c("Density of our function", "Density of true exponential distribution"), col = c("darkgray", "blue"), lty = c(1, 1), lwd = c(4, 4))
set.seed(98)
r_exp_Distr <- function(n, rate) {
u <- log(runif(n))
x <- -(1/rate) * u
return(x)
}
hist(r_exp_Distr(1000, 1), main = paste("Histogram of our function"), freq = F, col = "darkgray", lwd = 4) #Making the histogram of our function
lines(x = seq(0, 10, length.out = 1000), dexp(x = seq(0, 10, length.out = 1000), rate = 1), col="blue", lwd = 3) #Showing the true exponential distribution
legend(2, 0.6, c("Density of our function", "Density of true exponential distribution"), col = c("darkgray", "blue"), lty = c(1, 2), lwd = c(4, 4))
set.seed(98)
r_exp_Distr <- function(n, rate) {
u <- log(runif(n))
x <- -(1/rate) * u
return(x)
}
hist(r_exp_Distr(1000, 1), main = paste("Histogram of our function"), freq = F, col = "darkgray", lwd = 4) #Making the histogram of our function
lines(x = seq(0, 10, length.out = 1000), dexp(x = seq(0, 10, length.out = 1000), rate = 1), col="blue", lwd = 3) #Showing the true exponential distribution
legend(2, 0.6, c("Density of our function", "Density of true exponential distribution"), col = c("darkgray", "blue"), lty = c(1, 5), lwd = c(4, 4))
set.seed(98)
r_exp_Distr <- function(n, rate) {
u <- log(runif(n))
x <- -(1/rate) * u
return(x)
}
hist(r_exp_Distr(1000, 1), main = paste("Histogram of our function"), freq = F, col = "darkgray", lwd = 4) #Making the histogram of our function
lines(x = seq(0, 10, length.out = 1000), dexp(x = seq(0, 10, length.out = 1000), rate = 1), col="blue", lwd = 3, lty = 2) #Showing the true exponential distribution
legend(2, 0.6, c("Density of our function", "Density of true exponential distribution"), col = c("darkgray", "blue"), lty = c(1, 1), lwd = c(4, 4))
set.seed(98)
r_exp_Distr <- function(n, rate) {
u <- log(runif(n))
x <- -(1/rate) * u
return(x)
}
hist(r_exp_Distr(1000, 1), main = paste("Histogram of our function"), freq = F, col = "darkgray", lwd = 4) #Making the histogram of our function
lines(x = seq(0, 10, length.out = 1000), dexp(x = seq(0, 10, length.out = 1000), rate = 1), col="blue", lwd = 3, lty = 1) #Showing the true exponential distribution
legend(2, 0.6, c("Density of our function", "Density of true exponential distribution"), col = c("darkgray", "blue"), lty = c(1, 1), lwd = c(4, 4))
set.seed(1)
runif(10)
set.seed(2)
runif(10)
set.seed(1)
runif(10)
set.seed(2)
runif(10)
set.seed(1)
runif(10)
set.seed(2)
runif(10)
set.seed(1)
runif(10)
set.seed(2)
runif(10)
set.seed(1)
runif(10)
set.seed(2)
runif(10)
set.seed(1)
runif(10)
set.seed(2)
runif(10)
#set.seed(1)
runif(10)
#set.seed(2)
runif(10)
#set.seed(1)
runif(10)
#set.seed(2)
runif(10)
#set.seed(1)
runif(10)
#set.seed(2)
runif(10)
#set.seed(1)
runif(10)
#set.seed(2)
runif(10)
#set.seed(1)
runif(10)
#set.seed(2)
runif(10)
runif(0,1)
runif(n = 1,0,1)
set.seed(98) #I like this seed.
r_exp_Distr <- function(n, rate) {
u <- log(runif(n))
x <- -(1/rate) * u
return(x)
}
hist(r_exp_Distr(1000, 1), main = paste("Histogram of our function"), col = "darkgray", lwd = 4) #Making the histogram of our function
lines(x = seq(0, 10, length.out = 1000), dexp(x = seq(0, 10, length.out = 1000), rate = 1), col="blue", lwd = 3) #Showing the true exponential distribution
legend(2, 0.6, c("Density of our function", "Density of true exponential distribution"), col = c("darkgray", "blue"), lty = c(1, 1), lwd = c(4, 4))
set.seed(98) #I like this seed.
r_exp_Distr <- function(n, rate) {
u <- log(runif(n))
x <- -(1/rate) * u
return(x)
}
hist(r_exp_Distr(1000, 1), main = paste("Histogram of our function"), freq = F, col = "darkgray", lwd = 4) #Making the histogram of our function
lines(x = seq(0, 10, length.out = 1000), dexp(x = seq(0, 10, length.out = 1000), rate = 1), col="blue", lwd = 3) #Showing the true exponential distribution
legend(2, 0.6, c("Density of our function", "Density of true exponential distribution"), col = c("darkgray", "blue"), lty = c(1, 1), lwd = c(4, 4))
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = TRUE, tidy.opts = list(width.cutoff = 60), tidy = TRUE)
library("tidyverse")
library("ggfortify")
library("MASS")
set.seed(98) #I like this seed.
r_exp_Distr <- function(n, rate) {
u <- log(runif(n))
x <- -(1/rate) * u
return(x)
}
hist(r_exp_Distr(1000, 1), main = paste("Histogram of our function"), freq = F, col = "darkgray", lwd = 4) #Making the histogram of our function
lines(x = seq(0, 10, length.out = 1000), dexp(x = seq(0, 10, length.out = 1000), rate = 1), col="blue", lwd = 3) #Showing the true exponential distribution
legend(2, 0.6, c("Density of our function", "Density of true exponential distribution"), col = c("darkgray", "blue"), lty = c(1, 1), lwd = c(4, 4))
set.seed(98) #I like this seed.
r_exp_Distr <- function(n, rate) {
u <- log(runif(n))
x <- -(1/rate) * u
return(x)
}
hist(r_exp_Distr(1000, 1), main = paste("Histogram of our function"), freq = F, col = "darkgray", lwd = 4) #Making the histogram of our function
lines(x = seq(0, 10, length.out = 1000), dexp(x = seq(0, 10, length.out = 1000), rate = 1), col="blue", lwd = 3) #Showing the true exponential distribution
legend(2, 0.6, c("Density of our function", "Density of true exponential distribution"), col = c("darkgray", "blue"), lty = c(1, 1), lwd = c(4, 4))
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = TRUE, tidy.opts = list(width.cutoff = 60), tidy = TRUE)
library("tidyverse")
library("ggfortify")
library("MASS")
set.seed(98) #I like this seed.
r_exp_Distr <- function(n, rate) {
u <- log(runif(n))
x <- -(1/rate) * u
return(x)
}
hist(r_exp_Distr(10000, 1), main = paste("Histogram of our function"), freq = F, col = "darkgray", lwd = 4) #Making the histogram of our function
lines(x = seq(0, 10, length.out = 10000), dexp(x = seq(0, 10, length.out = 10000), rate = 1), col="blue", lwd = 3) #Showing the true exponential distribution
legend(2, 0.6, c("Density of our function", "Density of true exponential distribution"), col = c("darkgray", "blue"), lty = c(1, 1), lwd = c(4, 4))
set.seed(98) #I like this seed.
r_exp_Distr <- function(n, rate) {
u <- log(runif(n))
x <- -(1/rate) * u
return(x)
}
hist(r_exp_Distr(10000, 1), main = paste("Histogram of our function"), freq = F, col = "darkgray", lwd = 4) #Making the histogram of our function
lines(x = seq(0, 10, length.out = 10000), dexp(x = seq(0, 10, length.out = 10000), rate = 1), col="blue", lwd = 3) #Showing the true exponential distribution
legend(2, 0.6, c("Density of our function", "Density of true exponential distribution"), col = c("darkgray", "blue"), lty = c(1, 1), lwd = c(4, 4))
set.seed(98) #I like this seed.
r_exp_Distr <- function(n, rate) {
u <- log(runif(n))
x <- -(1/rate) * u
return(x)
}
hist(r_exp_Distr(10000, 1), main = paste("Histogram of our function"), freq = F, col = "darkgray", lwd = 4) #Making the histogram of our function
lines(x = seq(0, 10, length.out = 10000), dexp(x = seq(0, 10, length.out = 10000), rate = 1), col="blue", lwd = 3) #Showing the true exponential distribution
legend(2, 0.6, c("Density of our function", "Density of the true exponential distribution"), col = c("darkgray", "blue"), lty = c(1, 1), lwd = c(4, 4))
set.seed(98) #I like this seed.
r_exp_Distr <- function(n, rate) {
u <- log(runif(n))
x <- -(1/rate) * u
return(x)
}
hist(r_exp_Distr(10000,1),main=paste("Histogram of our function"),freq=F,col="darkgray",lwd=4)#Making the histogram of our function
lines(x=seq(0,10,length.out=10000),dexp(x=seq(0,10,length.out=10000),rate = 1),col="blue",lwd = 3)#Showing the true exponential distribution
legend(2,0.6,c("Density of our function","Density of the true exponential distribution"),col=c("darkgray","blue"),lty=c(1,1),lwd=c(4,4))
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = TRUE, tidy.opts = list(width.cutoff = 60), tidy = TRUE)
library("tidyverse")
library("ggfortify")
library("MASS")
set.seed(98)
f <- function(theta) {
return((2+theta)^125 * (1-theta)^38 * theta^34)
}
c <- optimize(f,c(0,1),maximum = T)
rej_samp <- function(n) {
samples <- rep(NA,n)
number_it = 0
for (i in 1:n) {
when_done <- 0
while (when_done == 0) {
theta_sample <- runif(1)
alpha <- f(theta_sample)/c$objective
u <- runif(1)
if (u <= alpha) {
samples[i] <- theta_sample
when_done <- 1
}
number_it <- number_it + 1
}
}
return(list(samples=samples,number_iterations=number_it))
}
norm_const <- integrate(f,0,1)$value
norm_const
set.seed(98)
f <- function(theta) {
return((2+theta)^125 * (1-theta)^38 * theta^34)
}
c <- optimize(f,c(0,1),maximum = T)
rej_samp <- function(n) {
samples <- rep(NA,n)
number_it = 0
for (i in 1:n) {
when_done <- 0
while (when_done == 0) {
theta_sample <- runif(1)
alpha <- f(theta_sample)/c$objective
u <- runif(1)
if (u <= alpha) {
samples[i] <- theta_sample
when_done <- 1
}
number_it <- number_it + 1
}
}
return(list(samples=samples,number_iterations=number_it))
}
n = 10000
g <- function(theta) {
return(theta * f(theta))
}
norm_const <- integrate(f,0,1)$value
norm_const
set.seed(98)
f <- function(theta) {
return((2 + theta)^125 * (1 - theta)^38 * theta^34)
}
c <- optimize(f, c(0, 1), maximum = T)
rej_samp <- function(n) {
samples <- rep(NA, n)
number_it = 0
for (i in 1:n) {
when_done <- 0
while (when_done == 0) {
theta_sample <- runif(1)
alpha <- f(theta_sample)/c$objective
u <- runif(1)
if (u <= alpha) {
samples[i] <- theta_sample
when_done <- 1
}
number_it <- number_it + 1
}
}
return(list(samples=samples, number_iterations=number_it))
}
n = 10000
g <- function(theta) {
return(theta * f(theta))
}
norm_const <- integrate(f,0,1)$value
f_density <- function(theta) {
return(f(theta)/norm_const)
}
y <- rej_samp(n)
# hist(rej_samp(10000)$samples,main="Histogram of our samples")
n = 10000
g <- function(theta) {
return(theta * f(theta))
}
norm_const <- integrate(f,0,1)$value
f_density <- function(theta) {
return(f(theta)/norm_const)
}
y <- rej_samp(n)
cat("Computed mean: ", sum(y$samples)/n, "\nTheoretical mean: ", integrate(g,0,1)$value/N_C)
n = 10000
g <- function(theta) {
return(theta * f(theta))
}
norm_const <- integrate(f,0,1)$value
f_density <- function(theta) {
return(f(theta)/norm_const)
}
y <- rej_samp(n)
cat("Computed mean: ", sum(y$samples)/n, "\nTheoretical mean: ", integrate(g,0,1)$value/norm_const)
# hist(rej_samp(10000)$samples,main="Histogram of our samples")
## 1.
We wish to sample from
We wish to sample from
hist(rej_samp(n)$samples, main="Histogram of our samples")
hist(rej_samp(n)$samples, main="Histogram of our samples", freq = F)
hist(y$samples, main="Histogram of our samples", freq = F, col = "darkgray", lwd = 4)
lines(x = y$samples, f_density(y$samples), col = "blue", lwd = 3)
hist(y$samples, main="Histogram of our samples", freq = F, col = "darkgray", lwd = 4)
lines(x = y$samples, f_density(y$samples), col = "blue", lwd = 3)
hist(y$samples, main="Histogram of our samples", freq = F, col = "darkgray", lwd = 4)
lines(x = y$samples, f_density(y$samples), col = "blue", lwd = 3)
legend(2, 0.6, c("Density of our function", "Density of the true exponential distribution"), col = c("darkgray", "blue"), lty = c(1, 1), lwd = c(4, 4))
legend(0.4, 8, c("Density of our function", "Density of the true exponential distribution"), col = c("darkgray", "blue"), lty = c(1, 1), lwd = c(4, 4))
hist(y$samples, main="Histogram of our samples", freq = F, col = "darkgray", lwd = 4)
lines(x = y$samples, f_density(y$samples), col = "blue", lwd = 3)
legend(0.4, 8, c("Density of our function", "Density of the true exponential distribution"), col = c("darkgray", "blue"), lty = c(1, 1), lwd = c(4, 4))
hist(y$samples, main="Histogram of our samples", freq = F, col = "darkgray", lwd = 4)
lines(x = y$samples, f_density(y$samples), col = "blue", lwd = 3)
legend(0.4, 8, c("Sampled f", "Analytical f"), col = c("darkgray", "blue"), lty = c(1, 1), lwd = c(4, 4))
hist(y$samples, main="Histogram of our samples", freq = F, col = "darkgray", lwd = 4)
lines(x = seq(0, 1, length.out = n), f_density(seq(0, 1, length.out = n)), col = "blue", lwd = 3)
legend(0.4, 8, c("Sampled f", "Analytical f"), col = c("darkgray", "blue"), lty = c(1, 1), lwd = c(4, 4))
set.seed(98) #I like this seed.
r_exp_Distr <- function(n, rate) {
u <- log(runif(n))
x <- -(1/rate) * u
return(x)
}
hist(r_exp_Distr(10000, 1), main = paste("Histogram of our function"), freq = F, col = "darkgray", lwd = 4) #Making the histogram of our function
lines(x = seq(0, 10, length.out = 10000), dexp(x = seq(0, 10, length.out = 10000), rate = 1), col = "blue", lwd = 3) #Showing the true exponential distribution
legend(2, 0.6, c("Density of our function", "Density of the true exponential distribution"), col = c("darkgray", "blue"), lty = c(1, 1), lwd = c(4, 4))
hist(y$samples, main="Histogram of our samples", freq = F, col = "darkgray", lwd = 4, xlim = c(0, 1))
hist(y$samples, main="Histogram of our samples", freq = F, col = "darkgray", lwd = 4, xlim = c(0, 1))
lines(x = seq(0, 1, length.out = n), f_density(seq(0, 1, length.out = n)), col = "blue", lwd = 3)
legend(0.4, 8, c("Sampled f", "Analytical f"), col = c("darkgray", "blue"), lty = c(1, 1), lwd = c(4, 4))
hist(y$samples, main="Histogram of our samples", freq = F, col = "darkgray", lwd = 4, xlim = c(0, 1))
lines(x = seq(0, 1, length.out = n), f_density(seq(0, 1, length.out = n)), col = "blue", lwd = 3)
abline(v = , col="red", lwd=3, lty=2)
legend(0, 8, c("Sampled f", "Analytical f"), col = c("darkgray", "blue"), lty = c(1, 1), lwd = c(4, 4))
hist(y$samples, main="Histogram of our samples", freq = F, col = "darkgray", lwd = 4, xlim = c(0, 1))
lines(x = seq(0, 1, length.out = n), f_density(seq(0, 1, length.out = n)), col = "blue", lwd = 3)
abline(v = sum(y$samples)/n, col="red", lwd=3, lty=2)
legend(0, 8, c("Sampled f", "Analytical f", "Computed mean"), col = c("darkgray", "blue", "red"), lty = c(1, 1), lwd = c(4, 4))
hist(y$samples, main="Histogram of our samples", freq = F, col = "darkgray", lwd = 4, xlim = c(0, 1))
lines(x = seq(0, 1, length.out = n), f_density(seq(0, 1, length.out = n)), col = "blue", lwd = 3)
abline(v = sum(y$samples)/n, col="red", lwd = 3, lty = 3)
legend(0, 8, c("Sampled f", "Analytical f", "Computed mean"), col = c("darkgray", "blue", "red"), lty = c(1, 1), lwd = c(4, 4))
hist(y$samples, main="Histogram of our samples", freq = F, col = "darkgray", lwd = 4, xlim = c(0, 1))
lines(x = seq(0, 1, length.out = n), f_density(seq(0, 1, length.out = n)), col = "blue", lwd = 3)
abline(v = sum(y$samples)/n, col="red", lwd = 3, lty = 4)
legend(0, 8, c("Sampled f", "Analytical f", "Computed mean"), col = c("darkgray", "blue", "red"), lty = c(1, 1), lwd = c(4, 4))
n = 10000
g <- function(theta) {
return(theta * f(theta))
}
norm_const <- integrate(f,0,1)$value
f_density <- function(theta) {
return(f(theta)/norm_const)
}
y <- rej_samp(n)
cat("Computed mean: ", sum(y$samples)/n, "\nTheoretical mean: ", integrate(g,0,1)$value/norm_const)
hist(y$samples, main="Histogram of our samples", freq = F, col = "darkgray", lwd = 4, xlim = c(0, 1))
lines(x = seq(0, 1, length.out = n), f_density(seq(0, 1, length.out = n)), col = "blue", lwd = 3)
abline(v = sum(y$samples)/n, col="red", lwd = 3, lty = 4)
legend(0, 8, c("Sampled f", "Analytical f", "Computed mean"), col = c("darkgray", "blue", "red"), lty = c(1, 1), lwd = c(4, 4))
hist(y$samples, main="Histogram of our samples", freq = F, col = "darkgray", lwd = 4, xlim = c(0, 1), ylim = c(0, 8))
lines(x = seq(0, 1, length.out = n), f_density(seq(0, 1, length.out = n)), col = "blue", lwd = 3)
abline(v = sum(y$samples)/n, col="red", lwd = 3, lty = 4)
legend(0, 8, c("Sampled f", "Analytical f", "Computed mean"), col = c("darkgray", "blue", "red"), lty = c(1, 1), lwd = c(4, 4))
hist(y$samples, main="Histogram of our samples", freq = F, col = "darkgray", lwd = 4, xlim = c(0, 1), ylim = c(0, 8))
lines(x = seq(0, 1, length.out = n), f_density(seq(0, 1, length.out = n)), col = "blue", lwd = 3)
abline(v = sum(y$samples)/n, col="pink", lwd = 3, lty = 4)
legend(0, 8, c("Sampled f", "Analytical f", "Computed mean"), col = c("darkgray", "blue", "pink"), lty = c(1, 1), lwd = c(4, 4))
hist(y$samples, main="Histogram of our samples", freq = F, col = "darkgray", lwd = 4, xlim = c(0, 1), ylim = c(0, 8))
lines(x = seq(0, 1, length.out = n), f_density(seq(0, 1, length.out = n)), col = "blue", lwd = 3)
abline(v = sum(y$samples)/n, col="red", lwd = 3, lty = 4)
legend(0, 8, c("Sampled f", "Analytical f", "Computed mean"), col = c("darkgray", "blue", "red"), lty = c(1, 1), lwd = c(4, 4))
hist(y$samples, main="Histogram of our samples", freq = F, col = "darkgray", lwd = 4, xlim = c(0, 1), ylim = c(0, 8))
lines(x = seq(0, 1, length.out = n), f_density(seq(0, 1, length.out = n)), col = "blue", lwd = 3)
abline(v = sum(y$samples)/n, col="red", lwd = 3, lty = 4)
abline(v = integrate(g,0,1)$value/norm_const, col="darkred", lwd = 3, lty = 4)
legend(0, 8, c("Sampled f", "Analytical f", "Computed mean", "Theoretical mean"), col = c("darkgray", "blue", "red", "darkred"), lty = c(1, 1), lwd = c(4, 4))
hist(y$samples, main="Histogram of our samples", freq = F, col = "darkgray", lwd = 4, xlim = c(0, 1), ylim = c(0, 8))
lines(x = seq(0, 1, length.out = n), f_density(seq(0, 1, length.out = n)), col = "blue", lwd = 3)
abline(v = sum(y$samples)/n, col="red", lwd = 3, lty = 4)
legend(0, 8, c("Sampled f", "Analytical f", "Computed mean"), col = c("darkgray", "blue", "red"), lty = c(1, 1), lwd = c(4, 4))
cat("Average random numbers generated: ", y$number_iterations/n, "\nTheoretical expected number: ", c/norm_const)
cat("Average random numbers generated: ", y$number_iterations/n, "\nTheoretical expected number: ", c$objective/norm_const)
