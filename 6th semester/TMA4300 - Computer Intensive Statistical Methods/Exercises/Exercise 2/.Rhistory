y_201 <- inv.logit(box_201$y)
#3
plot(NULL,NULL,ylim=c(mx(y_201,0),mx(y_201,1)),xlim=c(mx(x_201,0),mx(x_201,1)),ylab="Conditional likelihood",xlab="pi(tau_201)")
lines(x=x_201,y=y_201,col="black")
abline(v = mod$summary.fitted.values$mean[201], col="blue", lwd=3)
abline(v = mod$summary.fitted.values$`0.025quant`[201], col="blue", lwd=3, lty=2)
abline(v = mod$summary.fitted.values$`0.975quant`[201], col="blue", lwd=3, lty=2)
##day 356
box_201 <- inla.smarginal(mod$marginals.random$day$index.366,log =FALSE, extrapolate = 0.0, keep.type = FALSE, factor=15L)
x_356 <- inv.logit(box_201$x)
y_356 <- inv.logit(box_201$y)
#4
plot(NULL,NULL,ylim=c(mx(y_356,0),mx(y_356,1)),xlim=c(mx(x_356,0),mx(x_356,1)),ylab="Conditional likelihood",xlab="pi(tau_366)")
lines(x=x_356,y=y_356,col="black")
abline(v = mod$summary.fitted.values$mean[366], col="blue", lwd=3)
abline(v = mod$summary.fitted.values$`0.025quant`[366], col="blue", lwd=3, lty=2)
abline(v = mod$summary.fitted.values$`0.975quant`[366], col="blue", lwd=3, lty=2)
###1/sigma_u^2
box_hyper <- mod$marginals.hyperpar$`Precision for day`
q_1_sig <- mod$summary.hyperpar$`0.025quant`
q_2_sig <- mod$summary.hyperpar$`0.975quant`
q_mean_sig <- mod$summary.hyperpar$mean
x_hyp <- box_hyper[,1]
y_hyp <- box_hyper[,2]
#5
plot(NULL,NULL,ylim=c(mx(y_hyp,0),mx(y_hyp,1)),xlim=c(mx(x_hyp,0),mx(x_hyp,1)),ylab="Conditional likelihood",xlab="1/sigma_u^2")
lines(x=x_hyp,y=y_hyp,col="black")
abline(v = q_1_sig, col="blue", lwd=3, lty=2)
abline(v = q_2_sig, col="blue", lwd=3, lty=2)
abline(v = q_mean_sig, col="blue", lwd=3)
#make this func for simplisity (it is not significant)
mx <- function(list,max){
if (max == 1){
return(max(list))}
else{
return(min(list))}}
par(mfrow = c(2,2))
###day 1
box_1 <- inla.smarginal(mod$marginals.random$day$index.1,log =FALSE, extrapolate = 0.0, keep.type = FALSE, factor=15L)
x_1 <- inv.logit(box_1$x)
y_1 <- inv.logit(box_1$y)
#2
plot(NULL,NULL,ylim=c(mx(y_1,0),mx(y_1,1)),xlim=c(mx(x_1,0),mx(x_1,1)),ylab="Conditional likelihood",xlab="pi(tau_1)")
lines(x=x_1,y=y_1,col="black")
abline(v = mod$summary.fitted.values$mean[1], col="blue", lwd=3)
abline(v = mod$summary.fitted.values$`0.025quant`[1], col="blue", lwd=3, lty=2)
abline(v = mod$summary.fitted.values$`0.975quant`[1], col="blue", lwd=3, lty=2)
##day 201
box_201 <- inla.smarginal(mod$marginals.random$day$index.201,log =FALSE, extrapolate = 0.0, keep.type = FALSE, factor=15L)
x_201 <- inv.logit(box_201$x)
y_201 <- inv.logit(box_201$y)
#3
plot(NULL,NULL,ylim=c(mx(y_201,0),mx(y_201,1)),xlim=c(mx(x_201,0),mx(x_201,1)),ylab="Conditional likelihood",xlab="pi(tau_201)")
lines(x=x_201,y=y_201,col="black")
abline(v = mod$summary.fitted.values$mean[201], col="blue", lwd=3)
abline(v = mod$summary.fitted.values$`0.025quant`[201], col="blue", lwd=3, lty=2)
abline(v = mod$summary.fitted.values$`0.975quant`[201], col="blue", lwd=3, lty=2)
##day 356
box_201 <- inla.smarginal(mod$marginals.random$day$index.366,log =FALSE, extrapolate = 0.0, keep.type = FALSE, factor=15L)
x_356 <- inv.logit(box_201$x)
y_356 <- inv.logit(box_201$y)
#4
plot(NULL,NULL,ylim=c(mx(y_356,0),mx(y_356,1)),xlim=c(mx(x_356,0),mx(x_356,1)),ylab="Conditional likelihood",xlab="pi(tau_366)")
lines(x=x_356,y=y_356,col="black")
abline(v = mod$summary.fitted.values$mean[366], col="blue", lwd=3)
abline(v = mod$summary.fitted.values$`0.025quant`[366], col="blue", lwd=3, lty=2)
abline(v = mod$summary.fitted.values$`0.975quant`[366], col="blue", lwd=3, lty=2)
###1/sigma_u^2
box_hyper <- mod$marginals.hyperpar$`Precision for day`
q_1_sig <- mod$summary.hyperpar$`0.025quant`
q_2_sig <- mod$summary.hyperpar$`0.975quant`
q_mean_sig <- mod$summary.hyperpar$mean
x_hyp <- box_hyper[,1]
y_hyp <- box_hyper[,2]
#5
plot(NULL,NULL,ylim=c(mx(y_hyp,0),mx(y_hyp,1)),xlim=c(mx(x_hyp,0),mx(x_hyp,1)),ylab="Conditional likelihood",xlab="1/sigma_u^2")
lines(x=x_hyp,y=1/y_hyp,col="black")
abline(v = q_1_sig, col="blue", lwd=3, lty=2)
abline(v = q_2_sig, col="blue", lwd=3, lty=2)
abline(v = q_mean_sig, col="blue", lwd=3)
1/y_hyp
sigma2
#5
plot(1/y_hyp,ylim=c(mx(y_hyp,0),mx(y_hyp,1)),xlim=c(mx(x_hyp,0),mx(x_hyp,1)),ylab="Conditional likelihood",xlab="1/sigma_u^2")
#make this func for simplisity (it is not significant)
mx <- function(list,max){
if (max == 1){
return(max(list))}
else{
return(min(list))}}
par(mfrow = c(2,2))
###day 1
box_1 <- inla.smarginal(mod$marginals.random$day$index.1,log =FALSE, extrapolate = 0.0, keep.type = FALSE, factor=15L)
x_1 <- inv.logit(box_1$x)
y_1 <- inv.logit(box_1$y)
#2
plot(NULL,NULL,ylim=c(mx(y_1,0),mx(y_1,1)),xlim=c(mx(x_1,0),mx(x_1,1)),ylab="Conditional likelihood",xlab="pi(tau_1)")
lines(x=x_1,y=y_1,col="black")
abline(v = mod$summary.fitted.values$mean[1], col="blue", lwd=3)
abline(v = mod$summary.fitted.values$`0.025quant`[1], col="blue", lwd=3, lty=2)
abline(v = mod$summary.fitted.values$`0.975quant`[1], col="blue", lwd=3, lty=2)
##day 201
box_201 <- inla.smarginal(mod$marginals.random$day$index.201,log =FALSE, extrapolate = 0.0, keep.type = FALSE, factor=15L)
x_201 <- inv.logit(box_201$x)
y_201 <- inv.logit(box_201$y)
#3
plot(NULL,NULL,ylim=c(mx(y_201,0),mx(y_201,1)),xlim=c(mx(x_201,0),mx(x_201,1)),ylab="Conditional likelihood",xlab="pi(tau_201)")
lines(x=x_201,y=y_201,col="black")
abline(v = mod$summary.fitted.values$mean[201], col="blue", lwd=3)
abline(v = mod$summary.fitted.values$`0.025quant`[201], col="blue", lwd=3, lty=2)
abline(v = mod$summary.fitted.values$`0.975quant`[201], col="blue", lwd=3, lty=2)
##day 356
box_201 <- inla.smarginal(mod$marginals.random$day$index.366,log =FALSE, extrapolate = 0.0, keep.type = FALSE, factor=15L)
x_356 <- inv.logit(box_201$x)
y_356 <- inv.logit(box_201$y)
#4
plot(NULL,NULL,ylim=c(mx(y_356,0),mx(y_356,1)),xlim=c(mx(x_356,0),mx(x_356,1)),ylab="Conditional likelihood",xlab="pi(tau_366)")
lines(x=x_356,y=y_356,col="black")
abline(v = mod$summary.fitted.values$mean[366], col="blue", lwd=3)
abline(v = mod$summary.fitted.values$`0.025quant`[366], col="blue", lwd=3, lty=2)
abline(v = mod$summary.fitted.values$`0.975quant`[366], col="blue", lwd=3, lty=2)
###1/sigma_u^2
box_hyper <- mod$marginals.hyperpar$`Precision for day`
q_1_sig <- mod$summary.hyperpar$`0.025quant`
q_2_sig <- mod$summary.hyperpar$`0.975quant`
q_mean_sig <- mod$summary.hyperpar$mean
x_hyp <- box_hyper[,1]
y_hyp <- box_hyper[,2]
#5
plot(1/y_hyp,
# ylim=c(mx(y_hyp,0),mx(y_hyp,1)),xlim=c(mx(x_hyp,0),mx(x_hyp,1)),
ylab="Conditional likelihood",xlab="1/sigma_u^2")
# lines(x=x_hyp,y=1/y_hyp,col="black")
abline(v = q_1_sig, col="blue", lwd=3, lty=2)
abline(v = q_2_sig, col="blue", lwd=3, lty=2)
abline(v = q_mean_sig, col="blue", lwd=3)
#5
plot(1/y_hyp,
# ylim=c(mx(y_hyp,0),mx(y_hyp,1)),xlim=c(mx(x_hyp,0),mx(x_hyp,1)),
ylab="Conditional likelihood",xlab="1/sigma_u^2")
#make this func for simplisity (it is not significant)
mx <- function(list,max){
if (max == 1){
return(max(list))}
else{
return(min(list))}}
par(mfrow = c(2,2))
###day 1
box_1 <- inla.smarginal(mod$marginals.random$day$index.1,log =FALSE, extrapolate = 0.0, keep.type = FALSE, factor=15L)
x_1 <- inv.logit(box_1$x)
y_1 <- inv.logit(box_1$y)
#2
plot(NULL,NULL,ylim=c(mx(y_1,0),mx(y_1,1)),xlim=c(mx(x_1,0),mx(x_1,1)),ylab="Conditional likelihood",xlab="pi(tau_1)")
lines(x=x_1,y=y_1,col="black")
abline(v = mod$summary.fitted.values$mean[1], col="blue", lwd=3)
abline(v = mod$summary.fitted.values$`0.025quant`[1], col="blue", lwd=3, lty=2)
abline(v = mod$summary.fitted.values$`0.975quant`[1], col="blue", lwd=3, lty=2)
##day 201
box_201 <- inla.smarginal(mod$marginals.random$day$index.201,log =FALSE, extrapolate = 0.0, keep.type = FALSE, factor=15L)
x_201 <- inv.logit(box_201$x)
y_201 <- inv.logit(box_201$y)
#3
plot(NULL,NULL,ylim=c(mx(y_201,0),mx(y_201,1)),xlim=c(mx(x_201,0),mx(x_201,1)),ylab="Conditional likelihood",xlab="pi(tau_201)")
lines(x=x_201,y=y_201,col="black")
abline(v = mod$summary.fitted.values$mean[201], col="blue", lwd=3)
abline(v = mod$summary.fitted.values$`0.025quant`[201], col="blue", lwd=3, lty=2)
abline(v = mod$summary.fitted.values$`0.975quant`[201], col="blue", lwd=3, lty=2)
##day 356
box_201 <- inla.smarginal(mod$marginals.random$day$index.366,log =FALSE, extrapolate = 0.0, keep.type = FALSE, factor=15L)
x_356 <- inv.logit(box_201$x)
y_356 <- inv.logit(box_201$y)
#4
plot(NULL,NULL,ylim=c(mx(y_356,0),mx(y_356,1)),xlim=c(mx(x_356,0),mx(x_356,1)),ylab="Conditional likelihood",xlab="pi(tau_366)")
lines(x=x_356,y=y_356,col="black")
abline(v = mod$summary.fitted.values$mean[366], col="blue", lwd=3)
abline(v = mod$summary.fitted.values$`0.025quant`[366], col="blue", lwd=3, lty=2)
abline(v = mod$summary.fitted.values$`0.975quant`[366], col="blue", lwd=3, lty=2)
###1/sigma_u^2
box_hyper <- mod$marginals.hyperpar$`Precision for day`
q_1_sig <- mod$summary.hyperpar$`0.025quant`
q_2_sig <- mod$summary.hyperpar$`0.975quant`
q_mean_sig <- mod$summary.hyperpar$mean
x_hyp <- box_hyper[,1]
y_hyp <- box_hyper[,2]
#5
plot(1/y_hyp,ylim=c(mx(y_hyp,0),mx(y_hyp,1)),xlim=c(mx(x_hyp,0),mx(x_hyp,1)),ylab="Conditional likelihood",xlab="1/sigma_u^2")
lines(x=x_hyp,y=1/y_hyp,col="black")
abline(v = q_1_sig, col="blue", lwd=3, lty=2)
abline(v = q_2_sig, col="blue", lwd=3, lty=2)
abline(v = q_mean_sig, col="blue", lwd=3)
#make this func for simplisity (it is not significant)
mx <- function(list,max){
if (max == 1){
return(max(list))}
else{
return(min(list))}}
par(mfrow = c(2,2))
###day 1
box_1 <- inla.smarginal(mod$marginals.random$day$index.1,log =FALSE, extrapolate = 0.0, keep.type = FALSE, factor=15L)
x_1 <- inv.logit(box_1$x)
y_1 <- inv.logit(box_1$y)
#2
plot(NULL,NULL,ylim=c(mx(y_1,0),mx(y_1,1)),xlim=c(mx(x_1,0),mx(x_1,1)),ylab="Conditional likelihood",xlab="pi(tau_1)")
lines(x=x_1,y=y_1,col="black")
abline(v = mod$summary.fitted.values$mean[1], col="blue", lwd=3)
abline(v = mod$summary.fitted.values$`0.025quant`[1], col="blue", lwd=3, lty=2)
abline(v = mod$summary.fitted.values$`0.975quant`[1], col="blue", lwd=3, lty=2)
##day 201
box_201 <- inla.smarginal(mod$marginals.random$day$index.201,log =FALSE, extrapolate = 0.0, keep.type = FALSE, factor=15L)
x_201 <- inv.logit(box_201$x)
y_201 <- inv.logit(box_201$y)
#3
plot(NULL,NULL,ylim=c(mx(y_201,0),mx(y_201,1)),xlim=c(mx(x_201,0),mx(x_201,1)),ylab="Conditional likelihood",xlab="pi(tau_201)")
lines(x=x_201,y=y_201,col="black")
abline(v = mod$summary.fitted.values$mean[201], col="blue", lwd=3)
abline(v = mod$summary.fitted.values$`0.025quant`[201], col="blue", lwd=3, lty=2)
abline(v = mod$summary.fitted.values$`0.975quant`[201], col="blue", lwd=3, lty=2)
##day 356
box_201 <- inla.smarginal(mod$marginals.random$day$index.366,log =FALSE, extrapolate = 0.0, keep.type = FALSE, factor=15L)
x_356 <- inv.logit(box_201$x)
y_356 <- inv.logit(box_201$y)
#4
plot(NULL,NULL,ylim=c(mx(y_356,0),mx(y_356,1)),xlim=c(mx(x_356,0),mx(x_356,1)),ylab="Conditional likelihood",xlab="pi(tau_366)")
lines(x=x_356,y=y_356,col="black")
abline(v = mod$summary.fitted.values$mean[366], col="blue", lwd=3)
abline(v = mod$summary.fitted.values$`0.025quant`[366], col="blue", lwd=3, lty=2)
abline(v = mod$summary.fitted.values$`0.975quant`[366], col="blue", lwd=3, lty=2)
###1/sigma_u^2
box_hyper <- mod$marginals.hyperpar$`Precision for day`
q_1_sig <- mod$summary.hyperpar$`0.025quant`
q_2_sig <- mod$summary.hyperpar$`0.975quant`
q_mean_sig <- mod$summary.hyperpar$mean
x_hyp <- box_hyper[,1]
y_hyp <- box_hyper[,2]
#5
plot(1/y_hyp,ylim=c(mx(y_hyp,0),mx(y_hyp,1)),xlim=c(mx(x_hyp,0),mx(x_hyp,1)),ylab="Conditional likelihood",xlab="1/sigma_u^2")
lines(x=x_hyp,y=y_hyp,col="black")
abline(v = q_1_sig, col="blue", lwd=3, lty=2)
abline(v = q_2_sig, col="blue", lwd=3, lty=2)
abline(v = q_mean_sig, col="blue", lwd=3)
#make this func for simplisity (it is not significant)
mx <- function(list,max){
if (max == 1){
return(max(list))}
else{
return(min(list))}}
par(mfrow = c(2,2))
###day 1
box_1 <- inla.smarginal(mod$marginals.random$day$index.1,log =FALSE, extrapolate = 0.0, keep.type = FALSE, factor=15L)
x_1 <- inv.logit(box_1$x)
y_1 <- inv.logit(box_1$y)
#2
plot(NULL,NULL,ylim=c(mx(y_1,0),mx(y_1,1)),xlim=c(mx(x_1,0),mx(x_1,1)),ylab="Conditional likelihood",xlab="pi(tau_1)")
lines(x=x_1,y=y_1,col="black")
abline(v = mod$summary.fitted.values$mean[1], col="blue", lwd=3)
abline(v = mod$summary.fitted.values$`0.025quant`[1], col="blue", lwd=3, lty=2)
abline(v = mod$summary.fitted.values$`0.975quant`[1], col="blue", lwd=3, lty=2)
##day 201
box_201 <- inla.smarginal(mod$marginals.random$day$index.201,log =FALSE, extrapolate = 0.0, keep.type = FALSE, factor=15L)
x_201 <- inv.logit(box_201$x)
y_201 <- inv.logit(box_201$y)
#3
plot(NULL,NULL,ylim=c(mx(y_201,0),mx(y_201,1)),xlim=c(mx(x_201,0),mx(x_201,1)),ylab="Conditional likelihood",xlab="pi(tau_201)")
lines(x=x_201,y=y_201,col="black")
abline(v = mod$summary.fitted.values$mean[201], col="blue", lwd=3)
abline(v = mod$summary.fitted.values$`0.025quant`[201], col="blue", lwd=3, lty=2)
abline(v = mod$summary.fitted.values$`0.975quant`[201], col="blue", lwd=3, lty=2)
##day 356
box_201 <- inla.smarginal(mod$marginals.random$day$index.366,log =FALSE, extrapolate = 0.0, keep.type = FALSE, factor=15L)
x_356 <- inv.logit(box_201$x)
y_356 <- inv.logit(box_201$y)
#4
plot(NULL,NULL,ylim=c(mx(y_356,0),mx(y_356,1)),xlim=c(mx(x_356,0),mx(x_356,1)),ylab="Conditional likelihood",xlab="pi(tau_366)")
lines(x=x_356,y=y_356,col="black")
abline(v = mod$summary.fitted.values$mean[366], col="blue", lwd=3)
abline(v = mod$summary.fitted.values$`0.025quant`[366], col="blue", lwd=3, lty=2)
abline(v = mod$summary.fitted.values$`0.975quant`[366], col="blue", lwd=3, lty=2)
###1/sigma_u^2
box_hyper <- mod$marginals.hyperpar$`Precision for day`
q_1_sig <- mod$summary.hyperpar$`0.025quant`
q_2_sig <- mod$summary.hyperpar$`0.975quant`
q_mean_sig <- mod$summary.hyperpar$mean
x_hyp <- box_hyper[,1]
y_hyp <- box_hyper[,2]
#5
plot(NULL,NULL,ylim=c(mx(y_hyp,0),mx(y_hyp,1)),xlim=c(mx(x_hyp,0),mx(x_hyp,1)),ylab="Conditional likelihood",xlab="1/sigma_u^2")
lines(x=x_hyp,y=y_hyp,col="black")
abline(v = q_1_sig, col="blue", lwd=3, lty=2)
abline(v = q_2_sig, col="blue", lwd=3, lty=2)
abline(v = q_mean_sig, col="blue", lwd=3)
# par(mfrow = c(3,1))
plot(means, type = "l", lwd = 5, ylim = c(0,1), col = "red")
lines(meansBLOCK, type = "l", lwd = 3, col = "blue")
lines(mod$summary.fitted.values[,1], type = "l")
legend("topright", inset = .05, legend = c("MCMC", "MCMCBLOCK", "INLA"), lty = 1, col = c("red", "blue", "black"), cex=0.6)
ro <- function(x){return(round(x,3))}
#5
df <- data.frame(Cat = c("1/sigma_u^2","Tau_1", "Tau_201","Tau_366"),
INLA_Mean = linebreak(c(ro(mod$summary.hyperpar$mean),ro(mod$summary.fitted.values$mean[1]),ro(mod$summary.fitted.values$mean[201]),ro(mod$summary.fitted.values$mean[366]))),
MCMC_Individual = linebreak(c("X1","X2","X3","X4")),
MCMC_Block = linebreak(c("X1","X2","X3","X4")))
kable(df, col.names = c("","INLA_Mean","MCMC_Individual_Mean","MCMC_Block_Mean"), escape = F, caption = "Mean of marrginaldistributions") %>%
kable_styling(latex_options = "hold_position")
mean(sigma2
mean(sigma2)
sigma2
mean(1/sigma2)
ro <- function(x){return(round(x,3))}
#5
df <- data.frame(Cat = c("1/sigma_u^2","Tau_1", "Tau_201","Tau_366"),
INLA_Mean = linebreak(c(ro(mod$summary.hyperpar$mean),ro(mod$summary.fitted.values$mean[1]),ro(mod$summary.fitted.values$mean[201]),ro(mod$summary.fitted.values$mean[366]))),
MCMC_Individual = linebreak(c(mean(1/sigma2),"X2","X3","X4")),
MCMC_Block = linebreak(c("X1","X2","X3","X4")))
kable(df, col.names = c("","INLA_Mean","MCMC_Individual_Mean","MCMC_Block_Mean"), escape = F, caption = "Mean of marrginaldistributions") %>%
kable_styling(latex_options = "hold_position")
ro <- function(x){return(round(x,3))}
#5
df <- data.frame(Cat = c("1/sigma_u^2","Tau_1", "Tau_201","Tau_366"),
INLA_Mean = linebreak(c(ro(mod$summary.hyperpar$mean),ro(mod$summary.fitted.values$mean[1]),ro(mod$summary.fitted.values$mean[201]),ro(mod$summary.fitted.values$mean[366]))),
MCMC_Individual = linebreak(c(round(mean(1/sigma2),3),"X2","X3","X4")),
MCMC_Block = linebreak(c("X1","X2","X3","X4")))
kable(df, col.names = c("","INLA_Mean","MCMC_Individual_Mean","MCMC_Block_Mean"), escape = F, caption = "Mean of marrginaldistributions") %>%
kable_styling(latex_options = "hold_position")
ro <- function(x){return(round(x,3))}
#5
df <- data.frame(Cat = c("1/sigma_u^2","Tau_1", "Tau_201","Tau_366"),
INLA_Mean = linebreak(c(ro(mod$summary.hyperpar$mean),ro(mod$summary.fitted.values$mean[1]),ro(mod$summary.fitted.values$mean[201]),ro(mod$summary.fitted.values$mean[366]))),
MCMC_Individual = linebreak(c(round(mean(1/sigma2),3),"X2","X3","X4")),
MCMC_Block = linebreak(c(round(mean(1/sigma2BLOCK),3),"X2","X3","X4")))
kable(df, col.names = c("","INLA_Mean","MCMC_Individual_Mean","MCMC_Block_Mean"), escape = F, caption = "Mean of marrginaldistributions") %>%
kable_styling(latex_options = "hold_position")
ro <- function(x){return(round(x,3))}
#5
df <- data.frame(Cat = c("1/sigma_u^2","Tau_1", "Tau_201","Tau_366"),
INLA_Mean = linebreak(c(ro(mod$summary.hyperpar$mean),ro(mod$summary.fitted.values$mean[1]),ro(mod$summary.fitted.values$mean[201]),ro(mod$summary.fitted.values$mean[366]))),
MCMC_Individual = linebreak(c(round(mean(1/sigma2),3),mean(expit(taus[,1])),mean(expit(taus[,201])),mean(expit(taus[,366])))),
MCMC_Block = linebreak(c(round(mean(1/sigma2BLOCK),3),mean(expit(tausBLOCK[,1])),mean(expit(tausBLOCK[,201])),mean(expit(tausBLOCK[,366])))))
kable(df, col.names = c("","INLA_Mean","MCMC_Individual_Mean","MCMC_Block_Mean"), escape = F, caption = "Mean of marrginaldistributions") %>%
kable_styling(latex_options = "hold_position")
round(mean(1/sigma2BLOCK),3)
ro <- function(x){return(round(x,3))}
#5
df <- data.frame(Cat = c("1/sigma_u^2","Tau_1", "Tau_201","Tau_366"),
INLA_Mean = linebreak(c(ro(mod$summary.hyperpar$mean),ro(mod$summary.fitted.values$mean[1]),ro(mod$summary.fitted.values$mean[201]),ro(mod$summary.fitted.values$mean[366]))),
MCMC_Individual = linebreak(c(round(mean(1/sigma2),3),mean(expit(taus[,1])),mean(expit(taus[,201])),mean(expit(taus[,366])))),
MCMC_Block = linebreak(c(round(mean(1/sigma2BLOCK),3),mean(expit(tausBLOCK[,1])),mean(expit(tausBLOCK[,201])),mean(expit(tausBLOCK[,366])))))
kable(df, col.names = c("","INLA_Mean","MCMC_Individual_Mean","MCMC_Block_Mean"), escape = F, caption = "Mean of marrginaldistributions") %>%
kable_styling(latex_options = "hold_position")
df <- data.frame(Cat = c("sigma_u^2"),
INLA_Mean = linebreak(c(ro(1/mod$summary.hyperpar$mean))),
MCMC_Individual = linebreak(c("X1")),
MCMC_Block = linebreak(c("X1")))
kable(df, col.names = c("","INLA_Median","MCMC_Individual_Median","MCMC_Block_Median"), escape = F, caption = "Mean of marrginaldistributions") %>%
kable_styling(latex_options = "hold_position")
df <- data.frame(Cat = c("sigma_u^2"),
INLA_Mean = linebreak(c(ro(1/mod$summary.hyperpar$mean))),
MCMC_Individual = linebreak(c("X1")),
MCMC_Block = linebreak(c("X1")))
kable(df, col.names = c("","INLA_Median","MCMC_Individual_Median","MCMC_Block_Median"), escape = F, caption = "Mean of marrginaldistributions") %>%
kable_styling(latex_options = "hold_position")
df <- data.frame(Cat = c("sigma_u^2"),
INLA_Mean = linebreak(c(ro(1/mod$summary.hyperpar$mean))),
MCMC_Individual = linebreak(c(round(mean(1/sigma2),3))),
MCMC_Block = linebreak(c(round(mean(1/sigma2BLOCK),3))))
kable(df, col.names = c("","INLA_Median","MCMC_Individual_Median","MCMC_Block_Median"), escape = F, caption = "Mean of marrginaldistributions") %>%
kable_styling(latex_options = "hold_position")
df <- data.frame(Cat = c("sigma_u^2"),
INLA_Mean = linebreak(c(ro(1/mod$summary.hyperpar$mean))),
MCMC_Individual = linebreak(c(round(mean(sigma2),3))),
MCMC_Block = linebreak(c(round(mean(sigma2BLOCK),3))))
kable(df, col.names = c("","INLA_Median","MCMC_Individual_Median","MCMC_Block_Median"), escape = F, caption = "Mean of marrginaldistributions") %>%
kable_styling(latex_options = "hold_position")
cols <- brewer.pal(6,'Set2')
control.inla_1 = list(strategy = "auto", int.strategy = "ccd")
mods_1 <- inla(n.rain ~ -1 + f(day, model = "rw1", constr = FALSE,      hyper=list(prec=list(prior="loggamma", param=c(2, .05)))),
verbose = FALSE,
data = rain, Ntrials = n.years, control.compute = list(config = TRUE),
family = "binomial", control.inla = control.inla_1)
control.inla_2 = list(strategy = "gaussian", int.strategy = "ccd")
mods_2 <- inla(n.rain ~ -1 + f(day, model = "rw1", constr = FALSE,      hyper=list(prec=list(prior="loggamma", param=c(2, .05)))),
verbose = FALSE,
data = rain, Ntrials = n.years, control.compute = list(config = TRUE),
family = "binomial", control.inla = control.inla_2)
control.inla_3 = list(strategy = "simplified.laplace", int.strategy = "ccd")
mods_3 <- inla(n.rain ~ -1 + f(day, model = "rw1", constr = FALSE,      hyper=list(prec=list(prior="loggamma", param=c(2, .05)))),
verbose = FALSE,
data = rain, Ntrials = n.years, control.compute = list(config = TRUE),
family = "binomial", control.inla = control.inla_3)
control.inla_4 = list(strategy = "laplace", int.strategy = "ccd")
mods_4 <- inla(n.rain ~ -1 + f(day, model = "rw1", constr = FALSE,      hyper=list(prec=list(prior="loggamma", param=c(2, .05)))),
verbose = FALSE,
data = rain, Ntrials = n.years, control.compute = list(config = TRUE),
family = "binomial", control.inla = control.inla_4)
control.inla_5 = list(strategy = "adaptive", int.strategy = "ccd")
mods_5 <- inla(n.rain ~ -1 + f(day, model = "rw1", constr = FALSE,      hyper=list(prec=list(prior="loggamma", param=c(2, .05)))),
verbose = FALSE,
data = rain, Ntrials = n.years, control.compute = list(config = TRUE),
family = "binomial", control.inla = control.inla_5)
#7
plot(NULL,NULL,ylim=c(0,0.6),xlim=c(0,356),ylab="Probability of rain",xlab="day in a year",main ="int.strategy = ccd")
lines(x=c(1:length(mods_1$summary.fitted.values$mean)),y=c(mods_1$summary.fitted.values$mean),col=cols[1])
lines(x=c(1:length(mods_2$summary.fitted.values$mean)),y=c(mods_2$summary.fitted.values$mean),col=cols[2])
lines(x=c(1:length(mods_3$summary.fitted.values$mean)),y=c(mods_3$summary.fitted.values$mean),col=cols[3])
lines(x=c(1:length(mods_4$summary.fitted.values$mean)),y=c(mods_4$summary.fitted.values$mean),col=cols[4])
lines(x=c(1:length(mods_5$summary.fitted.values$mean)),y=c(mods_5$summary.fitted.values$mean),col=cols[5])
control.inla = list(strategy="simplified.laplace", int.strategy="ccd")
mod_new <- inla(n.rain ~ f(day, model="rw1", constr=TRUE),
data=rain, Ntrials=n.years, control.compute=list(config = TRUE),
family="binomial", verbose=FALSE, control.inla=control.inla)
cat("The intercept is", round(mod_new$summary.fixed$mean,3))
#10
plot(NULL,NULL,ylim=c(0,0.6),xlim=c(0,356),ylab="Probability of rain",xlab="days in a year")
lines(x=c(1:length(mod_new$summary.fitted.values$mean)),y=c(mod_new$summary.fitted.values$mean),col="red")
lines(x=c(1:length(mod$summary.fitted.values$mean)),y=c(mod$summary.fitted.values$mean))
legend("topleft",c("with intersept","without intersept"),fill=c("orange","black"))
#10
plot(NULL,NULL,ylim=c(0,0.6),xlim=c(0,356),ylab="Probability of rain",xlab="days in a year")
lines(x=c(1:length(mod_new$summary.fitted.values$mean)),y=c(mod_new$summary.fitted.values$mean),col="red")
lines(x=c(1:length(mod$summary.fitted.values$mean)),y=c(mod$summary.fitted.values$mean))
legend("topleft", inset = .05,c("with intersept","without intersept"),fill=c("orange","black"),cex = .6)
#11
diff <- mod_new$summary.fitted.values$mean - mod$summary.fitted.values$mean
plot(NULL,NULL,ylim=c(mx(diff,0),mx(diff,1)),xlim=c(0,356),ylab="Probability of rain",xlab="days in a year")
lines(x=c(1:length(diff)),y=c(diff),col="red")
legend("bottomleft",c("Difference of the two models"),fill=c("red"))
box_hyper_1 <- mod_new$marginals.hyperpar$`Precision for day`
x_hyp_1 <- box_hyper_1[,1]
y_hyp_1 <- box_hyper_1[,2]
#12
plot(NULL,NULL,ylim=c(mx(y_hyp_1,0),mx(y_hyp,1)),xlim=c(mx(x_hyp_1,0),mx(x_hyp_1,1)),ylab="Conditional likelihood",xlab="")
lines(x=x_hyp,y=y_hyp,col="black")
lines(x=x_hyp_1,y=y_hyp_1,col="red")
legend("topright",c("1/epsilon^2","1/sigma_u^2"),fill=c("red","black"))
box_hyper_1 <- mod_new$marginals.hyperpar$`Precision for day`
x_hyp_1 <- box_hyper_1[,1]
y_hyp_1 <- box_hyper_1[,2]
#12
plot(NULL,NULL,ylim=c(mx(y_hyp_1,0),mx(y_hyp,1)),xlim=c(mx(x_hyp_1,0),mx(x_hyp_1,1)),ylab="Conditional likelihood",xlab="")
lines(x=x_hyp,y=y_hyp,col="black")
lines(x=x_hyp_1,y=y_hyp_1,col="red")
legend("topright",c("1/epsilon^2","1/sigma_u^2"),fill=c("red","black"))
diff <- mod_new$summary.fitted.values$mean - mod$summary.fitted.values$mean
plot(NULL,NULL,ylim=c(mx(diff,0),mx(diff,1)),xlim=c(0,356),ylab="Probability of rain",xlab="days in a year")
lines(x=c(1:length(diff)),y=c(diff),col="red")
legend("bottomleft",inset = .05,c("Difference of the two models"),fill=c("red"),cex=.6)
box_hyper_1 <- mod_new$marginals.hyperpar$`Precision for day`
x_hyp_1 <- box_hyper_1[,1]
y_hyp_1 <- box_hyper_1[,2]
plot(NULL,NULL,ylim=c(mx(y_hyp_1,0),mx(y_hyp,1)),xlim=c(mx(x_hyp_1,0),mx(x_hyp_1,1)),ylab="Conditional likelihood",xlab="")
lines(x=x_hyp,y=y_hyp,col="black")
lines(x=x_hyp_1,y=y_hyp_1,col="red")
legend("topright",inset = .05,c("1/epsilon^2","1/sigma_u^2"),fill=c("red","black"),cex=.6)
cat("mean of random walks of model without intercept:",round(mean(mod$summary.random$day$mean),5))
cat("The intercept in the model with intercept:", round(mod_new$summary.fixed$mean,5))
cat("mean of random walks of model without intercept:",round(mean(mod$summary.random$day$mean),5),"\nThe intercept in the model with intercept:", round(mod_new$summary.fixed$mean,5))
cat("Mean of random walks of model without intercept:",round(mean(mod$summary.random$day$mean),5),"\nThe intercept in the model with intercept:    ", round(mod_new$summary.fixed$mean,5))
cat("Mean of random walks of model without intercept:",round(mean(mod$summary.random$day$mean),5),
"\nThe intercept in the model with intercept:     ", round(mod_new$summary.fixed$mean,5))
cat("Mean of random walks of model without intercept:",round(mean(mod$summary.random$day$mean),5),
"\nThe intercept in the model with intercept:      ", round(mod_new$summary.fixed$mean,5))
cat("Mean of random walks of model without intercept:",round(mean(mod$summary.random$day$mean),5),
"\nThe intercept in the model with intercept:      ", round(mod_new$summary.fixed$mean,5))
tinytex::reinstall_tinytex(repository = "illinois")
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = TRUE, tidy = TRUE, fig.align = "center", tidy.opts = list(width.cutoff = 60))
library("tidyverse")
library("ggfortify")
library("MASS")
library("knitr")
library("rmarkdown")
library("palmerpenguins")
library("GGally")
library("amen")
#install.packages("INLA", repos=c(getOption("repos"), INLA="https://inla.r-inla-download.org/R/stable"), dep=TRUE)
# update.packages("INLA", dep = TRUE)
library("INLA")
library("float")
library("invgamma")
library("mrbsizeR")
library("locfit")
library("coda")
library("likelihoodExplore")
library("boot")
library("kableExtra")
library("RColorBrewer")
df <- data.frame(Cat = c("sigma_u^2"),
INLA_Mean = linebreak(c(ro(1/mod$summary.hyperpar$mean))),
MCMC_Individual = linebreak(c(round(mean(sigma2),3))),
MCMC_Block = linebreak(c(round(mean(sigma2BLOCK),3))))
kable(df, col.names = c("","INLA_Median","MCMC_Individual_Median","MCMC_Block_Median"), escape = F, caption = "Mean of marrginaldistributions") %>%
kable_styling(latex_options = "hold_position")
cols <- brewer.pal(6,'Set2')
control.inla_1 = list(strategy = "auto", int.strategy = 'eb')
mods_1 <- inla(n.rain ~ -1 + f(day, model = "rw1", constr = FALSE, hyper=list(prec=list(prior="loggamma", param=c(2, .05)))), verbose = FALSE,
data = rain, Ntrials = n.years, control.compute = list(config = TRUE), family = "binomial", control.inla = control.inla_1)
control.inla_2 = list(strategy = "gaussian", int.strategy = 'eb')
mods_2 <- inla(n.rain ~ -1 + f(day, model = "rw1", constr = FALSE, hyper=list(prec=list(prior="loggamma", param=c(2, .05)))), verbose = FALSE,
data = rain, Ntrials = n.years, control.compute = list(config = TRUE), family = "binomial", control.inla = control.inla_2)
control.inla_3 = list(strategy = "simplified.laplace", int.strategy = 'eb')
mods_3 <- inla(n.rain ~ -1 + f(day, model = "rw1", constr = FALSE, hyper=list(prec=list(prior="loggamma", param=c(2, .05)))), verbose = FALSE,
data = rain, Ntrials = n.years, control.compute = list(config = TRUE), family = "binomial", control.inla = control.inla_3)
control.inla_4 = list(strategy = "laplace", int.strategy = 'eb')
mods_4 <- inla(n.rain ~ -1 + f(day, model = "rw1", constr = FALSE, hyper=list(prec=list(prior="loggamma", param=c(2, .05)))), verbose = FALSE,
data = rain, Ntrials = n.years, control.compute = list(config = TRUE), family = "binomial", control.inla = control.inla_4)
control.inla_5 = list(strategy = "adaptive", int.strategy = 'eb')
mods_5 <- inla(n.rain ~ -1 + f(day, model = "rw1", constr = FALSE, hyper=list(prec=list(prior="loggamma", param=c(2, .05)))), verbose = FALSE,
data = rain, Ntrials = n.years, control.compute = list(config = TRUE), family = "binomial", control.inla = control.inla_5)
plot(NULL,NULL,ylim=c(0,0.6),xlim=c(0,356),ylab="Probability of rain",xlab="day in a year",main ="int.strategy = eb")
lines(x=c(1:length(mods_1$summary.fitted.values$mean)),y=c(mods_1$summary.fitted.values$mean),col=cols[1])
lines(x=c(1:length(mods_2$summary.fitted.values$mean)),y=c(mods_2$summary.fitted.values$mean),col=cols[2])
lines(x=c(1:length(mods_3$summary.fitted.values$mean)),y=c(mods_3$summary.fitted.values$mean),col=cols[3])
lines(x=c(1:length(mods_4$summary.fitted.values$mean)),y=c(mods_4$summary.fitted.values$mean),col=cols[4])
lines(x=c(1:length(mods_5$summary.fitted.values$mean)),y=c(mods_5$summary.fitted.values$mean),col=cols[5])
