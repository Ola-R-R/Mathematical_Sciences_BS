}
plot(1:ncol(thr_p_A.OU.T),thr_p_A.OU.T[1,], col = league_pal("nba")[1],type="l",ylim=c(min(thr_p_A.OU.T),max(thr_p_A.OU.T)))
for (i in 2:30) {
lines(1:ncol(thr_p_A.OU.T),thr_p_A.OU.T[i,], col = league_pal("nba")[i])
}
plot(1:ncol(one_p_A.OU.T),one_p_A.OU.T[1,], col = league_pal("nba")[1],type="l",ylim=c(min(one_p_A.OU.T),max(one_p_A.OU.T)))
for (i in 2:30) {
lines(1:ncol(one_p_A.OU.T),one_p_A.OU.T[i,], col = league_pal("nba")[i])
}
plot(1:ncol(two_p_A.OU.T),two_p_A.OU.T[1,], col = league_pal("nba")[1],type="l",ylim=c(min(two_p_A.OU.T),max(two_p_A.OU.T)))
for (i in 2:30) {
lines(1:ncol(two_p_A.OU.T),two_p_A.OU.T[i,], col = league_pal("nba")[i])
}
plot(1:ncol(thr_p_A.OU.T),thr_p_A.OU.T[1,], col = league_pal("nba")[1],type="l",ylim=c(min(thr_p_A.OU.T),max(thr_p_A.OU.T)))
for (i in 2:30) {
lines(1:ncol(thr_p_A.OU.T),thr_p_A.OU.T[i,], col = league_pal("nba")[i])
}
plot(1:ncol(one_p_A.OU.T),one_p_A.OU.T[1,], col = league_pal("nba")[1],type="l",ylim=c(-.6,.6), xlab = "Days after 28.10.24",ylab="")
for (i in 2:30) {
lines(1:ncol(one_p_A.OU.T),one_p_A.OU.T[i,], col = league_pal("nba")[i])
}
plot(1:ncol(one_p_A.OU.T),one_p_A.OU.T[1,], col = league_pal("nba")[1],type="l",ylim=c(-.6,.6), xlab = "Days after 28.10.24",ylab="")
for (i in 2:30) {
lines(1:ncol(one_p_A.OU.T),one_p_A.OU.T[i,], col = league_pal("nba")[i])
}
plot(1:ncol(two_p_A.OU.T),two_p_A.OU.T[1,], col = league_pal("nba")[1],type="l",ylim=c(-.6,.6), xlab = "Days after 28.10.24",ylab="")
for (i in 2:30) {
lines(1:ncol(two_p_A.OU.T),two_p_A.OU.T[i,], col = league_pal("nba")[i])
}
plot(1:ncol(thr_p_A.OU.T),thr_p_A.OU.T[1,], col = league_pal("nba")[1],type="l",ylim=c(-.6,.6), xlab = "Days after 28.10.24",ylab="")
for (i in 2:30) {
lines(1:ncol(thr_p_A.OU.T),thr_p_A.OU.T[i,], col = league_pal("nba")[i])
}
plot(1:ncol(one_p_A.OU.T),one_p_A.OU.T[1,], col = league_pal("nba")[1],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.24 while the season is active",ylab="")
for (i in 2:30) {
lines(1:ncol(one_p_A.OU.T),one_p_A.OU.T[i,], col = league_pal("nba")[i])
}
plot(1:ncol(two_p_A.OU.T),two_p_A.OU.T[1,], col = league_pal("nba")[1],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.24 while the season is active",ylab="")
for (i in 2:30) {
lines(1:ncol(two_p_A.OU.T),two_p_A.OU.T[i,], col = league_pal("nba")[i])
}
plot(1:ncol(thr_p_A.OU.T),thr_p_A.OU.T[1,], col = league_pal("nba")[1],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.24 while the season is active",ylab="")
for (i in 2:30) {
lines(1:ncol(thr_p_A.OU.T),thr_p_A.OU.T[i,], col = league_pal("nba")[i])
}
plot(1:ncol(two_p_A.OU.T),two_p_A.OU.T[1,], col = league_pal("nba")[1],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.24 while the season is active",ylab="")
for (i in 2:30) {
lines(1:ncol(two_p_A.OU.T),two_p_A.OU.T[i,], col = league_pal("nba")[i])
}
plot(1:ncol(thr_p_A.OU.T),thr_p_A.OU.T[1,], col = league_pal("nba")[1],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.24 while the season is active",ylab="")
for (i in 2:30) {
lines(1:ncol(thr_p_A.OU.T),thr_p_A.OU.T[i,], col = league_pal("nba")[i])
}
plot(1:ncol(thr_p_A.OU.T),thr_p_A.OU.T[1,], col = league_pal("nba")[1],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.24 while the season is active",ylab="")
for (i in 2:30) {
lines(1:ncol(thr_p_A.OU.T),thr_p_A.OU.T[i,], col = league_pal("nba")[i])
}
plot(1:ncol(one_p_A.OU.T),one_p_A.OU.T[1,], col = league_pal("nba")[1],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
for (i in 2:30) {
lines(1:ncol(one_p_A.OU.T),one_p_A.OU.T[i,], col = league_pal("nba")[i])
}
plot(1:ncol(two_p_A.OU.T),two_p_A.OU.T[1,], col = league_pal("nba")[1],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
for (i in 2:30) {
lines(1:ncol(two_p_A.OU.T),two_p_A.OU.T[i,], col = league_pal("nba")[i])
}
plot(1:ncol(thr_p_A.OU.T),thr_p_A.OU.T[1,], col = league_pal("nba")[1],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
for (i in 2:30) {
lines(1:ncol(thr_p_A.OU.T),thr_p_A.OU.T[i,], col = league_pal("nba")[i])
}
one_p_D.OU.T <- rf.mod.OU.T$cond$`DEFENCE:TYPE`[seq(1,by = 3,length.out = 30),]
two_p_D.OU.T <- rf.mod.OU.T$cond$`DEFENCE:TYPE`[seq(2,by = 3,length.out = 30),]
thr_p_D.OU.T <- rf.mod.OU.T$cond$`DEFENCE:TYPE`[seq(3,by = 3,length.out = 30),]
plot(1:ncol(one_p_D.OU.T),one_p_D.OU.T[1,], col = league_pal("nba")[1],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
for (i in 2:30) {
lines(1:ncol(one_p_D.OU.T),one_p_D.OU.T[i,], col = league_pal("nba")[i])
}
plot(1:ncol(two_p_D.OU.T),two_p_D.OU.T[1,], col = league_pal("nba")[1],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
for (i in 2:30) {
lines(1:ncol(two_p_D.OU.T),two_p_D.OU.T[i,], col = league_pal("nba")[i])
}
plot(1:ncol(thr_p_D.OU.T),thr_p_D.OU.T[1,], col = league_pal("nba")[1],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
for (i in 2:30) {
lines(1:ncol(thr_p_D.OU.T),thr_p_D.OU.T[i,], col = league_pal("nba")[i])
}
one_p_D.OU.T <- rf.mod.OU.T$cond$`DEFENCE:TYPE`[seq(1,by = 3,length.out = 30),]
two_p_D.OU.T <- rf.mod.OU.T$cond$`DEFENCE:TYPE`[seq(2,by = 3,length.out = 30),]
thr_p_D.OU.T <- rf.mod.OU.T$cond$`DEFENCE:TYPE`[seq(3,by = 3,length.out = 30),]
plot(1:ncol(one_p_D.OU.T),one_p_D.OU.T[1,], col = league_pal("nba")[1],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
for (i in 2:30) {
lines(1:ncol(one_p_D.OU.T),one_p_D.OU.T[i,], col = league_pal("nba")[i])
}
plot(1:ncol(two_p_D.OU.T),two_p_D.OU.T[1,], col = league_pal("nba")[1],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
for (i in 2:30) {
lines(1:ncol(two_p_D.OU.T),two_p_D.OU.T[i,], col = league_pal("nba")[i])
}
plot(1:ncol(thr_p_D.OU.T),thr_p_D.OU.T[1,], col = league_pal("nba")[1],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
for (i in 2:30) {
lines(1:ncol(thr_p_D.OU.T),thr_p_D.OU.T[i,], col = league_pal("nba")[i])
}
mod1 <- mod.OU.T <- update(mod.F, . ~ 0 + TYPE * HOME + TYPE * COVID + HOME * COVID + ou(DATE+0|ATTACK:TYPE) + ou(DATE+0|DEFENCE:TYPE))
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = TRUE, tidy = TRUE, fig.align = "center", tidy.opts = list(width.cutoff = 60))
library("tidyverse")
library("aod")
library("lmtest")
library("readxl")
library("VGAM")
library("broom")
library("ggfortify")
library("MASS")
library("dampack")
library("mdscore")
library("formatR")
library("glmmTMB")
library("TMB")
library("stringr")
library("pals")
library("teamcolors")
library("corrplot")
library("lmtest")
mod1 <- update(mod.F, . ~ 0 + TYPE * HOME + TYPE * COVID + HOME * COVID + ou(DATE+0|ATTACK:TYPE) + ou(DATE+0|DEFENCE:TYPE))
mod1 <- glmmTMB(y ~ 0 + TYPE * HOME + HOME * COVID + ou(DATE+0|ATTACK:TYPE) + ou(DATE+0|DEFENCE:TYPE), box_score_20_21_season, poisson, REML=F)
mod1 <- glmmTMB(y ~ 0 + TYPE * HOME + TYPE * COVID + HOME * COVID + ou(DATE+0|ATTACK:TYPE) + ou(DATE+0|DEFENCE:TYPE), box_score_20_21_season, poisson, REML=F)
mod1 <- glmmTMB(y ~ 0 + TYPE * HOME + TYPE * COVID + HOME * COVID + ou(DATE+0|ATTACK:TYPE) + ou(DATE+0|DEFENCE:TYPE), box_score_20_21_season, poisson, REML=T)
update(mod.T, . ~ 0 + TYPE * HOME + HOME * COVID + ou(DATE+0|ATTACK:TYPE) + ou(DATE+0|DEFENCE:TYPE))
summary(update(mod.T, . ~ 0 + TYPE * HOME + HOME * COVID + ou(DATE+0|ATTACK:TYPE) + ou(DATE+0|DEFENCE:TYPE)))
summary(mod.OU.T)
mod2 <- update(mod.T, . ~ 0 + TYPE * HOME + HOME * COVID + ou(DATE+0|ATTACK:TYPE) + ou(DATE+0|DEFENCE:TYPE))
summary(mod2)
mod1 <- update(mod.F, . ~ 0 + TYPE * HOME + TYPE * COVID + HOME * COVID + ou(DATE+0|ATTACK:TYPE) + ou(DATE+0|DEFENCE:TYPE))
mod2 <- update(mod.F, . ~ 0 + TYPE * HOME + HOME * COVID + ou(DATE+0|ATTACK:TYPE) + ou(DATE+0|DEFENCE:TYPE))
anova(mod2,mod1)
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = TRUE, tidy = TRUE, fig.align = "center", tidy.opts = list(width.cutoff = 60))
library("tidyverse")
library("aod")
library("lmtest")
library("readxl")
library("VGAM")
library("broom")
library("ggfortify")
library("MASS")
library("dampack")
library("mdscore")
library("formatR")
library("glmmTMB")
library("TMB")
library("stringr")
library("pals")
library("teamcolors")
library("corrplot")
library("lmtest")
rf.mod.Best.T <- ranef(mod.Best.T)
barplot(rf.mod.Best.T$cond$ATTACK$TYPE1, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.T$cond$ATTACK), cex.names = .8, ylim = c(-.3,.3), main = "1 pointer att strength")
barplot(rf.mod.Best.T$cond$DEFENCE$TYPE1, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.T$cond$DEFENCE), cex.names = .8, ylim = c(-.3,.3), main = "1 pointer def strength")
barplot(rf.mod.Best.T$cond$ATTACK$TYPE2, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.T$cond$ATTACK), cex.names = .8, ylim = c(-.3,.3), main = "2 pointer att strength")
barplot(rf.mod.Best.T$cond$DEFENCE$TYPE2, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.T$cond$DEFENCE), cex.names = .8, ylim = c(-.3,.3), main = "2 pointer def strength")
barplot(rf.mod.Best.T$cond$ATTACK$TYPE3, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.T$cond$ATTACK), cex.names = .8, ylim = c(-.3,.3), main = "3 pointer att strength")
barplot(rf.mod.Best.T$cond$DEFENCE$TYPE3, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.T$cond$DEFENCE), cex.names = .8, ylim = c(-.3,.3), main = "3 pointer def strength")
rf.mod.Best.T <- ranef(mod.Best.T)
barplot(rf.mod.Best.T$cond$ATTACK$TYPE1, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.T$cond$ATTACK), cex.names = .8, ylim = c(-.3,.3), main = "1 pointer att strength")
barplot(rf.mod.Best.T$cond$DEFENCE$TYPE1, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.T$cond$DEFENCE), cex.names = .8, ylim = c(-.3,.3), main = "1 pointer def strength")
barplot(rf.mod.Best.T$cond$ATTACK$TYPE2, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.T$cond$ATTACK), cex.names = .8, ylim = c(-.3,.3), main = "2 pointer att strength")
barplot(rf.mod.Best.T$cond$DEFENCE$TYPE2, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.T$cond$DEFENCE), cex.names = .8, ylim = c(-.3,.3), main = "2 pointer def strength")
barplot(rf.mod.Best.T$cond$ATTACK$TYPE3, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.T$cond$ATTACK), cex.names = .8, ylim = c(-.3,.3), main = "3 pointer att strength")
barplot(rf.mod.Best.T$cond$DEFENCE$TYPE3, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.T$cond$DEFENCE), cex.names = .8, ylim = c(-.3,.3), main = "3 pointer def strength")
corrr <- cbind(rf.mod.Best.T$cond$ATTACK,rf.mod.Best.T$cond$DEFENCE)
colnames(corrr) <- c("Attack Type 1","Attack Type 2","Attack Type 3", "Defence Type 1","Defence Type 2","Defence Type 3")
plot(corrr, col = league_pal("nba"))
corrplot(cor(corrr), method = "number", diag = FALSE)
corrplot(cor(corrr), method = "shade", diag = FALSE)
corrplot(cor(corrr), method = "number", diag = FALSE)
corrplot(cor(corrr), method = "shade", diag = FALSE)
for (i in 2:30) {
lines(1:ncol(one_p_A.OU.T),one_p_A.OU.T[i,], col = league_pal("nba")[i])
}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = TRUE, tidy = TRUE, fig.align = "center", tidy.opts = list(width.cutoff = 60))
library("tidyverse")
library("aod")
library("lmtest")
library("readxl")
library("VGAM")
library("broom")
library("ggfortify")
library("MASS")
library("dampack")
library("mdscore")
library("formatR")
library("glmmTMB")
library("TMB")
library("stringr")
library("pals")
library("teamcolors")
library("corrplot")
library("lmtest")
rf.mod.OU.T <- ranef(mod.OU.T)
one_p_A.OU.T <- rf.mod.OU.T$cond$`ATTACK:TYPE`[seq(1,by = 3,length.out = 30),]
two_p_A.OU.T <- rf.mod.OU.T$cond$`ATTACK:TYPE`[seq(2,by = 3,length.out = 30),]
thr_p_A.OU.T <- rf.mod.OU.T$cond$`ATTACK:TYPE`[seq(3,by = 3,length.out = 30),]
plot(1:ncol(one_p_A.OU.T),one_p_A.OU.T[1,], col = league_pal("nba")[1],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
for (i in 2:30) {
lines(1:ncol(one_p_A.OU.T),one_p_A.OU.T[i,], col = league_pal("nba")[i])
}
plot(1:ncol(two_p_A.OU.T),two_p_A.OU.T[1,], col = league_pal("nba")[1],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
for (i in 2:30) {
lines(1:ncol(two_p_A.OU.T),two_p_A.OU.T[i,], col = league_pal("nba")[i])
}
plot(1:ncol(thr_p_A.OU.T),thr_p_A.OU.T[1,], col = league_pal("nba")[1],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
for (i in 2:30) {
lines(1:ncol(thr_p_A.OU.T),thr_p_A.OU.T[i,], col = league_pal("nba")[i])
}
plot(1:ncol(one_p_A.OU.T),one_p_A.OU.T[1,], col = league_pal("nba")[1],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
for (i in 2:30) {
lines(1:ncol(one_p_A.OU.T),one_p_A.OU.T[i,], col = league_pal("nba")[i])
}
plot(1:ncol(two_p_A.OU.T),two_p_A.OU.T[1,], col = league_pal("nba")[1],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
for (i in 2:30) {
lines(1:ncol(two_p_A.OU.T),two_p_A.OU.T[i,], col = league_pal("nba")[i])
}
plot(1:ncol(thr_p_A.OU.T),thr_p_A.OU.T[1,], col = league_pal("nba")[1],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
for (i in 2:30) {
lines(1:ncol(thr_p_A.OU.T),thr_p_A.OU.T[i,], col = league_pal("nba")[i])
}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = TRUE, tidy = TRUE, fig.align = "center", tidy.opts = list(width.cutoff = 60))
library("tidyverse")
library("aod")
library("lmtest")
library("readxl")
library("VGAM")
library("broom")
library("ggfortify")
library("MASS")
library("dampack")
library("mdscore")
library("formatR")
library("glmmTMB")
library("TMB")
library("stringr")
library("pals")
library("teamcolors")
library("corrplot")
library("lmtest")
summary(mod.Best.F)
summary(mod.Best.T)
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = TRUE, tidy = TRUE, fig.align = "center", tidy.opts = list(width.cutoff = 60))
library("tidyverse")
library("aod")
library("lmtest")
library("readxl")
library("VGAM")
library("broom")
library("ggfortify")
library("MASS")
library("dampack")
library("mdscore")
library("formatR")
library("glmmTMB")
library("TMB")
library("stringr")
library("pals")
library("teamcolors")
library("corrplot")
library("lmtest")
mod.F <- glmmTMB(y ~ 1, box_score, poisson, REML=F)
# The best models when REML = F and REML = T
mod.Best.F <- update(mod.F, .~ 0 + TYPE + TYPE:HOME + TYPE:COVID + HOME:COVID + (TYPE + 0|ATTACK) + (TYPE + 0|DEFENCE))
# summary(mod.Best.F)
estimates.SD <- round(cbind((summary(mod.Best.F)$coef$cond[,1]), (summary(mod.Best.F)$coef$cond[,2])),4)
colnames(estimates.SD) <- c("Estimate", "Std. Error")
estimates.SD
estimates.SD.exp <- round(exp(cbind((summary(mod.Best.F)$coef$cond[,1]), (summary(mod.Best.F)$coef$cond[,2]))),4)
colnames(estimates.SD.exp) <- c("Estimate", "Std. Error")
estimates.SD.exp
1-0.9774
1-0.9777
# Correlation Table
cortable <- cbind(rf.mod.Best.F$cond$ATTACK,rf.mod.Best.F$cond$DEFENCE)
# Correlation Table
rf.mod.Best.F <- ranef(mod.Best.F)
cortable <- cbind(rf.mod.Best.F$cond$ATTACK,rf.mod.Best.F$cond$DEFENCE)
colnames(cortable) <- c("Attack Type 1","Attack Type 2","Attack Type 3", "Defence Type 1","Defence Type 2","Defence Type 3")
plot(cortable, col = league_pal("nba"))
# Correlation Table
rf.mod.Best.F <- ranef(mod.Best.F)
cortable <- cbind(rf.mod.Best.F$cond$ATTACK,rf.mod.Best.F$cond$DEFENCE)
colnames(cortable) <- c("Attack Type 1","Attack Type 2","Attack Type 3", "Defence Type 1","Defence Type 2","Defence Type 3")
plot(cortable, col = league_pal("nba"))
plot(cortable, col = league_pal("nba"))
plot(cortable, col = league_pal("nba"),pch=18)
plot(cortable, col = league_pal("nba"), cex = 2, pch = 18)
plot(cortable, col = league_pal("nba"), cex = 1.5, pch = 18)
plot(cortable, col = league_pal("nba"), cex = 1.5, cex.axis = .8, pch = 18)
plot(cortable, col = league_pal("nba"), cex = 2, cex.axis = .8, pch = 18)
plot(cortable, col = league_pal("nba"), cex.axis = .8, pch = 19)
plot(cortable, col = league_pal("nba"), cex.axis = .8, pch = 19)
plot(cortable, col = league_pal("nba"), cex = 1.5, cex.axis = .8, pch = 19)
# Correlation Table
rf.mod.Best.F <- ranef(mod.Best.F)
cortable <- cbind(rf.mod.Best.F$cond$ATTACK,rf.mod.Best.F$cond$DEFENCE)
colnames(cortable) <- c("Attack Type 1","Attack Type 2","Attack Type 3", "Defence Type 1","Defence Type 2","Defence Type 3")
plot(cortable, col = league_pal("nba"), cex = 1.5, cex.axis = .8, pch = 19)
plot(cortable, col = league_pal("nba"), cex = 1.5, cex.axis = .8, pch = 19)
# Correlation Table
rf.mod.Best.F <- ranef(mod.Best.F)
cortable <- cbind(rf.mod.Best.F$cond$ATTACK,rf.mod.Best.F$cond$DEFENCE)
colnames(cortable) <- c("Attack Type 1","Attack Type 2","Attack Type 3", "Defence Type 1","Defence Type 2","Defence Type 3")
plot(cortable, col = league_pal("nba"), cex = 1.5, cex.axis = .8, pch = 19)
# Random Effects
rf.mod.Best.F <- ranef(mod.Best.F)
barplot(rf.mod.Best.F$cond$ATTACK$TYPE1, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$ATTACK), cex.names = .8, ylim = c(-.3,.3), main = "1 pointer att strength")
barplot(rf.mod.Best.F$cond$DEFENCE$TYPE1, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$DEFENCE), cex.names = .8, ylim = c(-.3,.3), main = "1 pointer def strength")
barplot(rf.mod.Best.F$cond$ATTACK$TYPE2, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$ATTACK), cex.names = .8, ylim = c(-.3,.3), main = "2 pointer att strength")
barplot(rf.mod.Best.F$cond$DEFENCE$TYPE2, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$DEFENCE), cex.names = .8, ylim = c(-.3,.3), main = "2 pointer def strength")
barplot(rf.mod.Best.F$cond$ATTACK$TYPE3, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$ATTACK), cex.names = .8, ylim = c(-.3,.3), main = "3 pointer att strength")
barplot(rf.mod.Best.F$cond$DEFENCE$TYPE3, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$DEFENCE), cex.names = .8, ylim = c(-.3,.3), main = "3 pointer def strength")
barplot(rf.mod.Best.F$cond$ATTACK$TYPE1, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$ATTACK), cex.names = .8, ylim = c(-.3,.3), main = "1 pointer att strength")
barplot(rf.mod.Best.F$cond$ATTACK$TYPE1, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$ATTACK), cex.names = .8, ylim = c(-.3,.3))
barplot(rf.mod.Best.F$cond$ATTACK$TYPE1, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$ATTACK), cex.names = .5, ylim = c(-.3,.3))
# Random Effects
rf.mod.Best.F <- ranef(mod.Best.F)
barplot(rf.mod.Best.F$cond$ATTACK$TYPE1, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$ATTACK), cex.names = .5, ylim = c(-.3,.3))
barplot(rf.mod.Best.F$cond$DEFENCE$TYPE1, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$DEFENCE), cex.names = .5, ylim = c(-.3,.3))
barplot(rf.mod.Best.F$cond$ATTACK$TYPE2, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$ATTACK), cex.names = .5, ylim = c(-.3,.3))
barplot(rf.mod.Best.F$cond$DEFENCE$TYPE2, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$DEFENCE), cex.names = .5, ylim = c(-.3,.3))
barplot(rf.mod.Best.F$cond$ATTACK$TYPE3, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$ATTACK), cex.names = .5, ylim = c(-.3,.3))
barplot(rf.mod.Best.F$cond$DEFENCE$TYPE3, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$DEFENCE), cex.names = .5, ylim = c(-.3,.3))
# Random Effects
rf.mod.Best.F <- ranef(mod.Best.F)
barplot(rf.mod.Best.F$cond$ATTACK$TYPE1, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$ATTACK), cex.names = .5, ylim = c(-.3,.3))
barplot(rf.mod.Best.F$cond$DEFENCE$TYPE1, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$DEFENCE), cex.names = .5, ylim = c(-.3,.3))
barplot(rf.mod.Best.F$cond$ATTACK$TYPE2, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$ATTACK), cex.names = .5, ylim = c(-.3,.3))
barplot(rf.mod.Best.F$cond$DEFENCE$TYPE2, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$DEFENCE), cex.names = .5, ylim = c(-.3,.3))
barplot(rf.mod.Best.F$cond$ATTACK$TYPE3, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$ATTACK), cex.names = .5, ylim = c(-.3,.3))
barplot(rf.mod.Best.F$cond$DEFENCE$TYPE3, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$DEFENCE), cex.names = .5, ylim = c(-.3,.3))
# Random Effects
rf.mod.Best.F <- ranef(mod.Best.F)
barplot(rf.mod.Best.F$cond$ATTACK$TYPE1, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$ATTACK), cex.names = .5, ylim = c(-.3,.3))
barplot(rf.mod.Best.F$cond$DEFENCE$TYPE1, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$DEFENCE), cex.names = .5, ylim = c(-.3,.3))
barplot(rf.mod.Best.F$cond$ATTACK$TYPE2, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$ATTACK), cex.names = .5, ylim = c(-.3,.3))
barplot(rf.mod.Best.F$cond$DEFENCE$TYPE2, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$DEFENCE), cex.names = .5, ylim = c(-.3,.3))
barplot(rf.mod.Best.F$cond$ATTACK$TYPE3, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$ATTACK), cex.names = .5, ylim = c(-.3,.3))
barplot(rf.mod.Best.F$cond$DEFENCE$TYPE3, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$DEFENCE), cex.names = .5, ylim = c(-.3,.3))
barplot(rf.mod.Best.F$cond$ATTACK$TYPE1, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$ATTACK), cex.names = .5, ylim = c(-.3,.3))
barplot(rf.mod.Best.F$cond$ATTACK$TYPE2, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$ATTACK), cex.names = .5, ylim = c(-.3,.3))
barplot(rf.mod.Best.F$cond$ATTACK$TYPE1, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$ATTACK), cex.names = .5, ylim = c(-.3,.3))
barplot(rf.mod.Best.F$cond$ATTACK$TYPE2, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$ATTACK), cex.names = .5, ylim = c(-.3,.3))
barplot(rf.mod.Best.F$cond$ATTACK$TYPE3, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$ATTACK), cex.names = .5, ylim = c(-.3,.3))
barplot(rf.mod.Best.F$cond$DEFENCE$TYPE1, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$DEFENCE), cex.names = .5, ylim = c(-.3,.3))
barplot(rf.mod.Best.F$cond$DEFENCE$TYPE2, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$DEFENCE), cex.names = .5, ylim = c(-.3,.3))
barplot(rf.mod.Best.F$cond$DEFENCE$TYPE3, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$DEFENCE), cex.names = .5, ylim = c(-.3,.3))
# Random Effects
rf.mod.Best.F <- ranef(mod.Best.F)
barplot(rf.mod.Best.F$cond$ATTACK$TYPE1, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$ATTACK), cex.names = .5, ylim = c(-.3,.3))
barplot(rf.mod.Best.F$cond$ATTACK$TYPE2, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$ATTACK), cex.names = .5, ylim = c(-.3,.3))
barplot(rf.mod.Best.F$cond$ATTACK$TYPE3, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$ATTACK), cex.names = .5, ylim = c(-.3,.3))
barplot(rf.mod.Best.F$cond$DEFENCE$TYPE1, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$DEFENCE), cex.names = .5, ylim = c(-.3,.3))
barplot(rf.mod.Best.F$cond$DEFENCE$TYPE2, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$DEFENCE), cex.names = .5, ylim = c(-.3,.3))
barplot(rf.mod.Best.F$cond$DEFENCE$TYPE3, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$DEFENCE), cex.names = .5, ylim = c(-.3,.3))
# Random Effects
rf.mod.Best.F <- ranef(mod.Best.F)
barplot(rf.mod.Best.F$cond$ATTACK$TYPE1, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$ATTACK), cex.names = .5, ylim = c(-.3,.3))
barplot(rf.mod.Best.F$cond$ATTACK$TYPE2, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$ATTACK), cex.names = .5, ylim = c(-.3,.3))
barplot(rf.mod.Best.F$cond$ATTACK$TYPE3, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$ATTACK), cex.names = .5, ylim = c(-.3,.3))
barplot(rf.mod.Best.F$cond$DEFENCE$TYPE1, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$DEFENCE), cex.names = .5, ylim = c(-.3,.3))
barplot(rf.mod.Best.F$cond$DEFENCE$TYPE2, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$DEFENCE), cex.names = .5, ylim = c(-.3,.3))
barplot(rf.mod.Best.F$cond$DEFENCE$TYPE3, col = league_pal("nba"), names.arg = rownames(rf.mod.Best.F$cond$DEFENCE), cex.names = .5, ylim = c(-.3,.3))
# The best model using fans for REML = F
mod.Best.Fans.F <- update(mod.F, .~ 0 + TYPE + TYPE:HOME + TYPE:N.FANS + HOME:N.FANS + (TYPE + 0|ATTACK) + (TYPE + 0|DEFENCE))
# summary(mod.Best.Fans.F)
estimates.SD.Fans <- round(cbind((summary(mod.Best.Fans.F)$coef$cond[,1]), (summary(mod.Best.Fans.F)$coef$cond[,2])),10)
colnames(estimates.SD.Fans) <- c("Estimate", "Std. Error")
estimates.SD.Fans
estimates.SD.exp.Fans <- round(exp(cbind((summary(mod.Best.Fans.F)$coef$cond[,1]), (summary(mod.Best.Fans.F)$coef$cond[,2]))),10)
colnames(estimates.SD.exp.Fans) <- c("Estimate", "Std. Error")
estimates.SD.exp.Fans
summary(mod.Best.F)
# Correlation Table
rf.mod.Best.F <- ranef(mod.Best.F)
cortable <- cbind(rf.mod.Best.F$cond$ATTACK,rf.mod.Best.F$cond$DEFENCE)
colnames(cortable) <- c("Attack Type 1","Attack Type 2","Attack Type 3", "Defence Type 1","Defence Type 2","Defence Type 3")
plot(cortable, col = league_pal("nba"), cex = 1.5, cex.axis = .8, pch = 19)
# Extending the best model with OU process
# mod.OU.F <- update(mod.F, . ~ 0 + TYPE + TYPE:HOME + TYPE:COVID + HOME:COVID + ou(DATE+0|ATTACK:TYPE) + ou(DATE+0|DEFENCE:TYPE))
# summary(mod.OU.F)
estimates.SD.OU <- round(cbind((summary(mod.OU.F)$coef$cond[,1]), (summary(mod.OU.F)$coef$cond[,2])),4)
estimates.SD.exp.Fans
estimates.SD.exp.Fans <- round(exp(cbind((summary(mod.Best.Fans.F)$coef$cond[,1]), (summary(mod.Best.Fans.F)$coef$cond[,2]))),4)
colnames(estimates.SD.exp.Fans) <- c("Estimate", "Std. Error")
estimates.SD.exp.Fans
estimates.SD.exp.Fans <- round(exp(cbind((summary(mod.Best.Fans.F)$coef$cond[,1]), (summary(mod.Best.Fans.F)$coef$cond[,2]))),5)
colnames(estimates.SD.exp.Fans) <- c("Estimate", "Std. Error")
estimates.SD.exp.Fans
estimates.SD.exp.Fans <- round(exp(cbind((summary(mod.Best.Fans.F)$coef$cond[,1]), (summary(mod.Best.Fans.F)$coef$cond[,2]))),10)
colnames(estimates.SD.exp.Fans) <- c("Estimate", "Std. Error")
estimates.SD.exp.Fans
estimates.SD.Fans
estimates.SD.exp.Fans
(summary(mod.Best.Fans.F)$coef$cond[,1])
exp((summary(mod.Best.Fans.F)$coef$cond[,1]) * 20000)
round(exp((summary(mod.Best.Fans.F)$coef$cond[,1]) * 20000))
round(exp((summary(mod.Best.Fans.F)$coef$cond[,1]) * 20000),4)
cbind(round(exp((summary(mod.Best.Fans.F)$coef$cond[,1]) * 20000),4))
cbind(round(exp((summary(mod.Best.Fans.F)$coef$cond[7,1]) * 20000),4))
cbind(round(exp((summary(mod.Best.Fans.F)$coef$cond[8,1]) * 20000),4))
cbind(round(exp((summary(mod.Best.Fans.F)$coef$cond[9,1]) * 20000),4))
1-cbind(round(exp((summary(mod.Best.Fans.F)$coef$cond[9,1]) * 20000),4))
estimates.SD.Fans
estimates.SD.exp.Fans
# Extending the best model with OU process
mod.OU.F <- update(mod.F, . ~ 0 + TYPE + TYPE:HOME + TYPE:COVID + HOME:COVID + ou(DATE+0|ATTACK:TYPE) + ou(DATE+0|DEFENCE:TYPE))
# summary(mod.OU.F)
estimates.SD.OU <- round(cbind((summary(mod.OU.F)$coef$cond[,1]), (summary(mod.OU.F)$coef$cond[,2])),4)
colnames(estimates.SD.OU) <- c("Estimate", "Std. Error")
estimates.SD.OU
estimates.SD.exp.OU <- round(exp(cbind((summary(mod.OU.F)$coef$cond[,1]), (summary(mod.OU.F)$coef$cond[,2]))),4)
colnames(estimates.SD.exp.OU) <- c("Estimate", "Std. Error")
estimates.SD.exp.OU
rf.mod.OU.F <- ranef(mod.OU.F)
one_p_A.OU.F <- rf.mod.OU.F$cond$`ATTACK:TYPE`[seq(1,by = 3,length.out = 30),]
two_p_A.OU.F <- rf.mod.OU.F$cond$`ATTACK:TYPE`[seq(2,by = 3,length.out = 30),]
thr_p_A.OU.F <- rf.mod.OU.F$cond$`ATTACK:TYPE`[seq(3,by = 3,length.out = 30),]
plot(1:ncol(one_p_A.OU.F),one_p_A.OU.F[1,], col = league_pal("nba")[1],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
for (i in 2:30) {
lines(1:ncol(one_p_A.OU.F),one_p_A.OU.F[i,], col = league_pal("nba")[i])
}
plot(1:ncol(two_p_A.OU.F),two_p_A.OU.F[1,], col = league_pal("nba")[1],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
for (i in 2:30) {
lines(1:ncol(two_p_A.OU.F),two_p_A.OU.F[i,], col = league_pal("nba")[i])
}
plot(1:ncol(thr_p_A.OU.F),thr_p_A.OU.F[1,], col = league_pal("nba")[1],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
for (i in 2:30) {
lines(1:ncol(thr_p_A.OU.F),thr_p_A.OU.F[i,], col = league_pal("nba")[i])
}
rf.mod.OU.F <- ranef(mod.OU.F)
one_p_A.OU.F <- rf.mod.OU.F$cond$`ATTACK:TYPE`[seq(1,by = 3,length.out = 30),]
two_p_A.OU.F <- rf.mod.OU.F$cond$`ATTACK:TYPE`[seq(2,by = 3,length.out = 30),]
thr_p_A.OU.F <- rf.mod.OU.F$cond$`ATTACK:TYPE`[seq(3,by = 3,length.out = 30),]
plot(1:ncol(one_p_A.OU.F),one_p_A.OU.F[1,], col = league_pal("nba")[1],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
for (i in 2:30) {
lines(1:ncol(one_p_A.OU.F),one_p_A.OU.F[i,], col = league_pal("nba")[i])
}
plot(1:ncol(two_p_A.OU.F),two_p_A.OU.F[1,], col = league_pal("nba")[1],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
for (i in 2:30) {
lines(1:ncol(two_p_A.OU.F),two_p_A.OU.F[i,], col = league_pal("nba")[i])
}
plot(1:ncol(thr_p_A.OU.F),thr_p_A.OU.F[1,], col = league_pal("nba")[1],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
for (i in 2:30) {
lines(1:ncol(thr_p_A.OU.F),thr_p_A.OU.F[i,], col = league_pal("nba")[i])
}
plot(1:ncol(one_p_A.OU.F),one_p_A.OU.F[1,], col = league_pal("nba")[1],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
for (i in 2:30) {
lines(1:ncol(one_p_A.OU.F),one_p_A.OU.F[i,], col = league_pal("nba")[i])
}
plot(1:ncol(two_p_A.OU.F),two_p_A.OU.F[1,], col = league_pal("nba")[1],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
for (i in 2:30) {
lines(1:ncol(two_p_A.OU.F),two_p_A.OU.F[i,], col = league_pal("nba")[i])
}
plot(1:ncol(thr_p_A.OU.F),thr_p_A.OU.F[1,], col = league_pal("nba")[1],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
for (i in 2:30) {
lines(1:ncol(thr_p_A.OU.F),thr_p_A.OU.F[i,], col = league_pal("nba")[i])
}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = TRUE, tidy = TRUE, fig.align = "center", tidy.opts = list(width.cutoff = 60))
library("tidyverse")
library("aod")
library("lmtest")
library("readxl")
library("VGAM")
library("broom")
library("ggfortify")
library("MASS")
library("dampack")
library("mdscore")
library("formatR")
library("glmmTMB")
library("TMB")
library("stringr")
library("pals")
library("teamcolors")
library("corrplot")
library("lmtest")
plot(1:ncol(two_p_A.OU.F),two_p_A.OU.F[10,], col = league_pal("nba")[10],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
plot(1:ncol(thr_p_A.OU.F),thr_p_A.OU.F[10,], col = league_pal("nba")[10],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
plot(1:ncol(two_p_A.OU.F),two_p_A.OU.F[10,], col = league_pal("nba")[10],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
abline(h = 0)
plot(1:ncol(two_p_A.OU.F),two_p_A.OU.F[10,], col = league_pal("nba")[10],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
abline(h = 0)
plot(1:ncol(thr_p_A.OU.F),thr_p_A.OU.F[10,], col = league_pal("nba")[10],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
abline(h = 0)
plot(1:ncol(two_p_A.OU.F),two_p_A.OU.F[10,], col = league_pal("nba")[10],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
abline(h = 0)
plot(1:ncol(thr_p_A.OU.F),thr_p_A.OU.F[10,], col = league_pal("nba")[10],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
abline(h = 0)
plot(1:ncol(two_p_A.OU.F),two_p_A.OU.F[11,], col = league_pal("nba")[11],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
abline(h = 0)
plot(1:ncol(thr_p_A.OU.F),thr_p_A.OU.F[11,], col = league_pal("nba")[11],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
abline(h = 0)
plot(1:ncol(two_p_A.OU.F),two_p_A.OU.F[10,], col = league_pal("nba")[10],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
abline(h = 0)
plot(1:ncol(thr_p_A.OU.F),thr_p_A.OU.F[10,], col = league_pal("nba")[10],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
abline(h = 0)
plot(1:ncol(two_p_A.OU.F),two_p_A.OU.F[11,], col = league_pal("nba")[11],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
abline(h = 0)
plot(1:ncol(thr_p_A.OU.F),thr_p_A.OU.F[11,], col = league_pal("nba")[11],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
abline(h = 0)
plot(1:ncol(two_p_A.OU.F),two_p_A.OU.F[10,], col = league_pal("nba")[10],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
abline(h = 0)
plot(1:ncol(thr_p_A.OU.F),thr_p_A.OU.F[10,], col = league_pal("nba")[10],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
abline(h = 0)
plot(1:ncol(two_p_A.OU.F),two_p_A.OU.F[11,], col = league_pal("nba")[11],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
abline(h = 0)
plot(1:ncol(thr_p_A.OU.F),thr_p_A.OU.F[11,], col = league_pal("nba")[11],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
abline(h = 0)
plot(1:ncol(two_p_A.OU.F),two_p_A.OU.F[10,], col = league_pal("nba")[10],type="l",ylim=c(-.6,.6), xlab = "Days after 27.10.14 while the season is active",ylab="")
abline(h = 0)
